"use client";
import {createContext,lazy,memo,useContext,isValidElement,useId,useTransition,useState,useMemo,useEffect,Suspense,useRef,useCallback}from'react';import {harden}from'rehype-harden';import ke from'rehype-katex';import pn from'rehype-raw';import un from'rehype-sanitize';import fn from'remark-cjk-friendly';import gn from'remark-cjk-friendly-gfm-strikethrough';import bn from'remark-gfm';import xe from'remark-math';import hn from'remend';import {DownloadIcon,CheckIcon,CopyIcon,Maximize2Icon,XIcon,Loader2Icon,ZoomInIcon,ZoomOutIcon,RotateCcwIcon}from'lucide-react';import {clsx}from'clsx';import {twMerge}from'tailwind-merge';import {jsx,jsxs,Fragment}from'react/jsx-runtime';import {toJsxRuntime}from'hast-util-to-jsx-runtime';import Oo from'remark-parse';import Ho from'remark-rehype';import {unified}from'unified';import {Lexer}from'marked';import Tt from'shiki/langs/bash.mjs';import Zo from'shiki/langs/css.mjs';import Mt from'shiki/langs/go.mjs';import Go from'shiki/langs/html.mjs';import Yo from'shiki/langs/javascript.mjs';import Qo from'shiki/langs/json.mjs';import en from'shiki/langs/jsx.mjs';import Pt from'shiki/langs/markdown.mjs';import Nt from'shiki/langs/python.mjs';import Rt from'shiki/langs/shellscript.mjs';import tn from'shiki/langs/sql.mjs';import on from'shiki/langs/toml.mjs';import nn from'shiki/langs/tsx.mjs';import rn from'shiki/langs/typescript.mjs';import St from'shiki/langs/yaml.mjs';var $t=300,zt="300px",Ft=500;function ve(e={}){let{immediate:t=false,debounceDelay:n=$t,rootMargin:o=zt,idleTimeout:a=Ft}=e,[r,c]=useState(false),s=useRef(null),l=useRef(null),i=useRef(null),d=useMemo(()=>g=>{let u=Date.now();return window.setTimeout(()=>{g({didTimeout:false,timeRemaining:()=>Math.max(0,50-(Date.now()-u))});},1)},[]),m=useMemo(()=>typeof window!="undefined"&&window.requestIdleCallback?(g,u)=>window.requestIdleCallback(g,u):d,[d]),p=useMemo(()=>typeof window!="undefined"&&window.cancelIdleCallback?g=>window.cancelIdleCallback(g):g=>{clearTimeout(g);},[]);return useEffect(()=>{if(t){c(true);return}let g=s.current;if(!g)return;l.current&&(clearTimeout(l.current),l.current=null),i.current&&(p(i.current),i.current=null);let u=()=>{l.current&&(clearTimeout(l.current),l.current=null),i.current&&(p(i.current),i.current=null);},b=M=>{i.current=m(v=>{v.timeRemaining()>0||v.didTimeout?(c(true),M.disconnect()):i.current=m(()=>{c(true),M.disconnect();},{timeout:a/2});},{timeout:a});},y=M=>{u(),l.current=window.setTimeout(()=>{var S,E;let v=M.takeRecords();(v.length===0||((E=(S=v.at(-1))==null?void 0:S.isIntersecting)!=null?E:false))&&b(M);},n);},k=(M,v)=>{M.isIntersecting?y(v):u();},T=new IntersectionObserver(M=>{for(let v of M)k(v,T);},{rootMargin:o,threshold:0});return T.observe(g),()=>{l.current&&clearTimeout(l.current),i.current&&p(i.current),T.disconnect();}},[t,n,o,a,p,m]),{shouldRender:r,containerRef:s}}var f=(...e)=>twMerge(clsx(e)),L=(e,t,n)=>{let o=typeof t=="string"?new Blob([t],{type:n}):t,a=URL.createObjectURL(o),r=document.createElement("a");r.href=a,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a);};var Wt=createContext({code:""}),U=()=>useContext(Wt);var le=({onCopy:e,onError:t,timeout:n=2e3,children:o,className:a,code:r,...c})=>{let[s,l]=useState(false),i=useRef(0),{code:d}=U(),{isAnimating:m}=useContext(P),p=r!=null?r:d,g=async()=>{var b;if(typeof window=="undefined"||!((b=navigator==null?void 0:navigator.clipboard)!=null&&b.writeText)){t==null||t(new Error("Clipboard API not available"));return}try{s||(await navigator.clipboard.writeText(p),l(!0),e==null||e(),i.current=window.setTimeout(()=>l(!1),n));}catch(y){t==null||t(y);}};useEffect(()=>()=>{window.clearTimeout(i.current);},[]);let u=s?CheckIcon:CopyIcon;return jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",a),"data-streamdown":"code-block-copy-button",disabled:m,onClick:g,title:"Copy Code",type:"button",...c,children:o!=null?o:jsx(u,{size:14})})};var Te={"1c":"1c","1c-query":"1cq",abap:"abap","actionscript-3":"as",ada:"ada",adoc:"adoc","angular-html":"html","angular-ts":"ts",apache:"conf",apex:"cls",apl:"apl",applescript:"applescript",ara:"ara",asciidoc:"adoc",asm:"asm",astro:"astro",awk:"awk",ballerina:"bal",bash:"sh",bat:"bat",batch:"bat",be:"be",beancount:"beancount",berry:"berry",bibtex:"bib",bicep:"bicep",blade:"blade.php",bsl:"bsl",c:"c","c#":"cs","c++":"cpp",cadence:"cdc",cairo:"cairo",cdc:"cdc",clarity:"clar",clj:"clj",clojure:"clj","closure-templates":"soy",cmake:"cmake",cmd:"cmd",cobol:"cob",codeowners:"CODEOWNERS",codeql:"ql",coffee:"coffee",coffeescript:"coffee","common-lisp":"lisp",console:"sh",coq:"v",cpp:"cpp",cql:"cql",crystal:"cr",cs:"cs",csharp:"cs",css:"css",csv:"csv",cue:"cue",cypher:"cql",d:"d",dart:"dart",dax:"dax",desktop:"desktop",diff:"diff",docker:"dockerfile",dockerfile:"dockerfile",dotenv:"env","dream-maker":"dm",edge:"edge",elisp:"el",elixir:"ex",elm:"elm","emacs-lisp":"el",erb:"erb",erl:"erl",erlang:"erl",f:"f","f#":"fs",f03:"f03",f08:"f08",f18:"f18",f77:"f77",f90:"f90",f95:"f95",fennel:"fnl",fish:"fish",fluent:"ftl",for:"for","fortran-fixed-form":"f","fortran-free-form":"f90",fs:"fs",fsharp:"fs",fsl:"fsl",ftl:"ftl",gdresource:"tres",gdscript:"gd",gdshader:"gdshader",genie:"gs",gherkin:"feature","git-commit":"gitcommit","git-rebase":"gitrebase",gjs:"js",gleam:"gleam","glimmer-js":"js","glimmer-ts":"ts",glsl:"glsl",gnuplot:"plt",go:"go",gql:"gql",graphql:"graphql",groovy:"groovy",gts:"gts",hack:"hack",haml:"haml",handlebars:"hbs",haskell:"hs",haxe:"hx",hbs:"hbs",hcl:"hcl",hjson:"hjson",hlsl:"hlsl",hs:"hs",html:"html","html-derivative":"html",http:"http",hxml:"hxml",hy:"hy",imba:"imba",ini:"ini",jade:"jade",java:"java",javascript:"js",jinja:"jinja",jison:"jison",jl:"jl",js:"js",json:"json",json5:"json5",jsonc:"jsonc",jsonl:"jsonl",jsonnet:"jsonnet",jssm:"jssm",jsx:"jsx",julia:"jl",kotlin:"kt",kql:"kql",kt:"kt",kts:"kts",kusto:"kql",latex:"tex",lean:"lean",lean4:"lean",less:"less",liquid:"liquid",lisp:"lisp",lit:"lit",llvm:"ll",log:"log",logo:"logo",lua:"lua",luau:"luau",make:"mak",makefile:"mak",markdown:"md",marko:"marko",matlab:"m",md:"md",mdc:"mdc",mdx:"mdx",mediawiki:"wiki",mermaid:"mmd",mips:"s",mipsasm:"s",mmd:"mmd",mojo:"mojo",move:"move",nar:"nar",narrat:"narrat",nextflow:"nf",nf:"nf",nginx:"conf",nim:"nim",nix:"nix",nu:"nu",nushell:"nu",objc:"m","objective-c":"m","objective-cpp":"mm",ocaml:"ml",pascal:"pas",perl:"pl",perl6:"p6",php:"php",plsql:"pls",po:"po",polar:"polar",postcss:"pcss",pot:"pot",potx:"potx",powerquery:"pq",powershell:"ps1",prisma:"prisma",prolog:"pl",properties:"properties",proto:"proto",protobuf:"proto",ps:"ps",ps1:"ps1",pug:"pug",puppet:"pp",purescript:"purs",py:"py",python:"py",ql:"ql",qml:"qml",qmldir:"qmldir",qss:"qss",r:"r",racket:"rkt",raku:"raku",razor:"cshtml",rb:"rb",reg:"reg",regex:"regex",regexp:"regexp",rel:"rel",riscv:"s",rs:"rs",rst:"rst",ruby:"rb",rust:"rs",sas:"sas",sass:"sass",scala:"scala",scheme:"scm",scss:"scss",sdbl:"sdbl",sh:"sh",shader:"shader",shaderlab:"shader",shell:"sh",shellscript:"sh",shellsession:"sh",smalltalk:"st",solidity:"sol",soy:"soy",sparql:"rq",spl:"spl",splunk:"spl",sql:"sql","ssh-config":"config",stata:"do",styl:"styl",stylus:"styl",svelte:"svelte",swift:"swift","system-verilog":"sv",systemd:"service",talon:"talon",talonscript:"talon",tasl:"tasl",tcl:"tcl",templ:"templ",terraform:"tf",tex:"tex",tf:"tf",tfvars:"tfvars",toml:"toml",ts:"ts","ts-tags":"ts",tsp:"tsp",tsv:"tsv",tsx:"tsx",turtle:"ttl",twig:"twig",typ:"typ",typescript:"ts",typespec:"tsp",typst:"typ",v:"v",vala:"vala",vb:"vb",verilog:"v",vhdl:"vhdl",vim:"vim",viml:"vim",vimscript:"vim",vue:"vue","vue-html":"html","vue-vine":"vine",vy:"vy",vyper:"vy",wasm:"wasm",wenyan:"wy",wgsl:"wgsl",wiki:"wiki",wikitext:"wiki",wit:"wit",wl:"wl",wolfram:"wl",xml:"xml",xsl:"xsl",yaml:"yaml",yml:"yml",zenscript:"zs",zig:"zig",zsh:"zsh",\u6587\u8A00:"wy"},Pe=({onDownload:e,onError:t,language:n,children:o,className:a,code:r,...c})=>{let{code:s}=U(),{isAnimating:l}=useContext(P),i=r!=null?r:s,m=`file.${n&&n in Te?Te[n]:"txt"}`,p="text/plain",g=()=>{try{L(m,i,p),e==null||e();}catch(u){t==null||t(u);}};return jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",a),"data-streamdown":"code-block-download-button",disabled:l,onClick:g,title:"Download file",type:"button",...c,children:o!=null?o:jsx(DownloadIcon,{size:14})})};var de=()=>jsxs("div",{className:"w-full divide-y divide-border overflow-hidden rounded-xl border border-border",children:[jsx("div",{className:"h-[46px] w-full bg-muted/80"}),jsx("div",{className:"flex w-full items-center justify-center p-4",children:jsx(Loader2Icon,{className:"size-4 animate-spin"})})]});var so=/\.[^/.]+$/,Ne=({node:e,className:t,src:n,alt:o,...a})=>{let r=async()=>{if(n)try{let s=await(await fetch(n)).blob(),i=new URL(n,window.location.origin).pathname.split("/").pop()||"",d=i.split(".").pop(),m=i.includes(".")&&d!==void 0&&d.length<=4,p="";if(m)p=i;else {let g=s.type,u="png";g.includes("jpeg")||g.includes("jpg")?u="jpg":g.includes("png")?u="png":g.includes("svg")?u="svg":g.includes("gif")?u="gif":g.includes("webp")&&(u="webp"),p=`${(o||i||"image").replace(so,"")}.${u}`;}L(p,s,s.type);}catch(c){console.error("Failed to download image:",c);}};return n?jsxs("div",{className:"group relative my-4 inline-block","data-streamdown":"image-wrapper",children:[jsx("img",{alt:o,className:f("max-w-full rounded-lg",t),"data-streamdown":"image",src:n,...a}),jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-lg bg-black/10 group-hover:block"}),jsx("button",{className:f("absolute right-2 bottom-2 flex h-8 w-8 cursor-pointer items-center justify-center rounded-md border border-border bg-background/90 shadow-sm backdrop-blur-sm transition-all duration-200 hover:bg-background","opacity-0 group-hover:opacity-100"),onClick:r,title:"Download image",type:"button",children:jsx(DownloadIcon,{size:14})})]}):null};var Z=async e=>{let n={...{startOnLoad:false,theme:"default",securityLevel:"strict",fontFamily:"monospace",suppressErrorRendering:true},...e},a=(await import('mermaid')).default;return a.initialize(n),a},Re=(e,t)=>{var o;let n=(o=void 0)!=null?o:5;return new Promise((a,r)=>{let c="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),s=new Image;s.crossOrigin="anonymous",s.onload=()=>{let l=document.createElement("canvas"),i=s.width*n,d=s.height*n;l.width=i,l.height=d;let m=l.getContext("2d");if(!m){r(new Error("Failed to create 2D canvas context for PNG export"));return}m.drawImage(s,0,0,i,d),l.toBlob(p=>{if(!p){r(new Error("Failed to create PNG blob"));return}a(p);},"image/png");},s.onerror=()=>r(new Error("Failed to load SVG image")),s.src=c;})};var Ee=({chart:e,children:t,className:n,onDownload:o,config:a,onError:r})=>{let[c,s]=useState(false),l=useRef(null),{isAnimating:i}=useContext(P),d=async m=>{try{if(m==="mmd"){L("diagram.mmd",e,"text/plain"),s(!1),o==null||o(m);return}let p=await Z(a),g=e.split("").reduce((y,k)=>(y<<5)-y+k.charCodeAt(0)|0,0),u=`mermaid-${Math.abs(g)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:b}=await p.render(u,e);if(!b){r==null||r(new Error("SVG not found. Please wait for the diagram to render."));return}if(m==="svg"){L("diagram.svg",b,"image/svg+xml"),s(!1),o==null||o(m);return}if(m==="png"){let y=await Re(b);L("diagram.png",y,"image/png"),o==null||o(m),s(!1);return}}catch(p){r==null||r(p);}};return useEffect(()=>{let m=p=>{l.current&&!l.current.contains(p.target)&&s(false);};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m);}},[]),jsxs("div",{className:"relative",ref:l,children:[jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",n),disabled:i,onClick:()=>s(!c),title:"Download diagram",type:"button",children:t!=null?t:jsx(DownloadIcon,{size:14})}),c?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>d("svg"),title:"Download diagram as SVG",type:"button",children:"SVG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>d("png"),title:"Download diagram as PNG",type:"button",children:"PNG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>d("mmd"),title:"Download diagram as MMD",type:"button",children:"MMD"})]}):null]})};var _=0,ho=()=>{_+=1,_===1&&(document.body.style.overflow="hidden");},yo=()=>{_=Math.max(0,_-1),_===0&&(document.body.style.overflow="");},je=({chart:e,config:t,onFullscreen:n,onExit:o,className:a,...r})=>{let[c,s]=useState(false),{isAnimating:l,controls:i}=useContext(P),d=(()=>{if(typeof i=="boolean")return i;let p=i.mermaid;return p===false?false:p===true||p===void 0?true:p.panZoom!==false})(),m=()=>{s(!c);};return useEffect(()=>{if(c){ho();let p=g=>{g.key==="Escape"&&s(false);};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),yo();}}},[c]),useEffect(()=>{c?n==null||n():o&&o();},[c,n,o]),jsxs(Fragment,{children:[jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",a),disabled:l,onClick:m,title:"View fullscreen",type:"button",...r,children:jsx(Maximize2Icon,{size:14})}),c?jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/95 backdrop-blur-sm",onClick:m,onKeyDown:p=>{p.key==="Escape"&&m();},role:"button",tabIndex:0,children:[jsx("button",{className:"absolute top-4 right-4 z-10 rounded-md p-2 text-muted-foreground transition-all hover:bg-muted hover:text-foreground",onClick:m,title:"Exit fullscreen",type:"button",children:jsx(XIcon,{size:20})}),jsx("div",{className:"flex size-full items-center justify-center p-4",onClick:p=>p.stopPropagation(),onKeyDown:p=>p.stopPropagation(),role:"presentation",children:jsx(Le,{chart:e,className:"size-full [&_svg]:h-auto [&_svg]:w-auto",config:t,fullscreen:true,showControls:d})})]}):null]})};var G=e=>{var r,c;let t=[],n=[],o=e.querySelectorAll("thead th");for(let s of o)t.push(((r=s.textContent)==null?void 0:r.trim())||"");let a=e.querySelectorAll("tbody tr");for(let s of a){let l=[],i=s.querySelectorAll("td");for(let d of i)l.push(((c=d.textContent)==null?void 0:c.trim())||"");n.push(l);}return {headers:t,rows:n}},Y=e=>{let{headers:t,rows:n}=e,o=s=>{let l=false,i=false;for(let d of s){if(d==='"'){l=true,i=true;break}(d===","||d===`
`)&&(l=true);}return l?i?`"${s.replace(/"/g,'""')}"`:`"${s}"`:s},a=t.length>0?n.length+1:n.length,r=new Array(a),c=0;t.length>0&&(r[c]=t.map(o).join(","),c+=1);for(let s of n)r[c]=s.map(o).join(","),c+=1;return r.join(`
`)},Be=e=>{let{headers:t,rows:n}=e,o=s=>{let l=false;for(let d of s)if(d==="	"||d===`
`||d==="\r"){l=true;break}if(!l)return s;let i=[];for(let d of s)d==="	"?i.push("\\t"):d===`
`?i.push("\\n"):d==="\r"?i.push("\\r"):i.push(d);return i.join("")},a=t.length>0?n.length+1:n.length,r=new Array(a),c=0;t.length>0&&(r[c]=t.map(o).join("	"),c+=1);for(let s of n)r[c]=s.map(o).join("	"),c+=1;return r.join(`
`)},me=e=>{let t=false;for(let o of e)if(o==="\\"||o==="|"){t=true;break}if(!t)return e;let n=[];for(let o of e)o==="\\"?n.push("\\\\"):o==="|"?n.push("\\|"):n.push(o);return n.join("")},Ae=e=>{let{headers:t,rows:n}=e;if(t.length===0)return "";let o=new Array(n.length+2),a=0,r=t.map(s=>me(s));o[a]=`| ${r.join(" | ")} |`,a+=1;let c=new Array(t.length);for(let s=0;s<t.length;s+=1)c[s]="---";o[a]=`| ${c.join(" | ")} |`,a+=1;for(let s of n)if(s.length<t.length){let l=new Array(t.length);for(let i=0;i<t.length;i+=1)l[i]=i<s.length?me(s[i]):"";o[a]=`| ${l.join(" | ")} |`,a+=1;}else {let l=s.map(i=>me(i));o[a]=`| ${l.join(" | ")} |`,a+=1;}return o.join(`
`)};var $e=({children:e,className:t,onCopy:n,onError:o,timeout:a=2e3})=>{let[r,c]=useState(false),[s,l]=useState(false),i=useRef(null),d=useRef(0),{isAnimating:m}=useContext(P),p=async u=>{var b,y;if(typeof window=="undefined"||!((b=navigator==null?void 0:navigator.clipboard)!=null&&b.write)){o==null||o(new Error("Clipboard API not available"));return}try{let k=(y=i.current)==null?void 0:y.closest('[data-streamdown="table-wrapper"]'),T=k==null?void 0:k.querySelector("table");if(!T){o==null||o(new Error("Table not found"));return}let M=G(T),v=u==="csv"?Y(M):Be(M),R=new ClipboardItem({"text/plain":new Blob([v],{type:"text/plain"}),"text/html":new Blob([T.outerHTML],{type:"text/html"})});await navigator.clipboard.write([R]),l(!0),c(!1),n==null||n(u),d.current=window.setTimeout(()=>l(!1),a);}catch(k){o==null||o(k);}};useEffect(()=>{let u=b=>{i.current&&!i.current.contains(b.target)&&c(false);};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u),window.clearTimeout(d.current);}},[]);let g=s?CheckIcon:CopyIcon;return jsxs("div",{className:"relative",ref:i,children:[jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:m,onClick:()=>c(!r),title:"Copy table",type:"button",children:e!=null?e:jsx(g,{size:14})}),r?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("csv"),title:"Copy table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("tsv"),title:"Copy table as TSV",type:"button",children:"TSV"})]}):null]})};var Fe=({children:e,className:t,onDownload:n,onError:o})=>{let[a,r]=useState(false),c=useRef(null),{isAnimating:s}=useContext(P),l=i=>{var d;try{let m=(d=c.current)==null?void 0:d.closest('[data-streamdown="table-wrapper"]'),p=m==null?void 0:m.querySelector("table");if(!p){o==null||o(new Error("Table not found"));return}let g=G(p),u=i==="csv"?Y(g):Ae(g);L(`table.${i==="csv"?"csv":"md"}`,u,i==="csv"?"text/csv":"text/markdown"),r(!1),n==null||n(i);}catch(m){o==null||o(m);}};return useEffect(()=>{let i=d=>{c.current&&!c.current.contains(d.target)&&r(false);};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i);}},[]),jsxs("div",{className:"relative",ref:c,children:[jsx("button",{className:f("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:s,onClick:()=>r(!a),title:"Download table",type:"button",children:e!=null?e:jsx(DownloadIcon,{size:14})}),a?jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>l("csv"),title:"Download table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>l("markdown"),title:"Download table as Markdown",type:"button",children:"Markdown"})]}):null]})};var Xe=({children:e,className:t,showControls:n,...o})=>jsxs("div",{className:"my-4 flex flex-col space-y-2","data-streamdown":"table-wrapper",children:[n?jsxs("div",{className:"flex items-center justify-end gap-1",children:[jsx($e,{}),jsx(Fe,{})]}):null,jsx("div",{className:"overflow-x-auto",children:jsx("table",{className:f("w-full border-collapse border border-border",t),"data-streamdown":"table",...o,children:e})})]});var So=lazy(()=>import('./code-block-LUI4OL5H.js').then(e=>({default:e.CodeBlock}))),Eo=lazy(()=>import('./mermaid-M2UIITPU.js').then(e=>({default:e.Mermaid}))),Do=/language-([^\s]+)/;function ne(e,t){if(!(e!=null&&e.position||t!=null&&t.position))return  true;if(!(e!=null&&e.position&&(t!=null&&t.position)))return  false;let n=e.position.start,o=t.position.start,a=e.position.end,r=t.position.end;return (n==null?void 0:n.line)===(o==null?void 0:o.line)&&(n==null?void 0:n.column)===(o==null?void 0:o.column)&&(a==null?void 0:a.line)===(r==null?void 0:r.line)&&(a==null?void 0:a.column)===(r==null?void 0:r.column)}function C(e,t){return e.className===t.className&&ne(e.node,t.node)}var ue=(e,t)=>typeof e=="boolean"?e:e[t]!==false,oe=(e,t)=>{if(typeof e=="boolean")return e;let n=e.mermaid;return n===false?false:n===true||n===void 0?true:n[t]!==false},fe=memo(({children:e,className:t,node:n,...o})=>jsx("ol",{className:f("list-inside list-decimal whitespace-normal [li_&]:pl-6",t),"data-streamdown":"ordered-list",...o,children:e}),(e,t)=>C(e,t));fe.displayName="MarkdownOl";var Ue=memo(({children:e,className:t,node:n,...o})=>jsx("li",{className:f("py-1 [&>p]:inline",t),"data-streamdown":"list-item",...o,children:e}),(e,t)=>e.className===t.className&&ne(e.node,t.node));Ue.displayName="MarkdownLi";var Ke=memo(({children:e,className:t,node:n,...o})=>jsx("ul",{className:f("list-inside list-disc whitespace-normal [li_&]:pl-6",t),"data-streamdown":"unordered-list",...o,children:e}),(e,t)=>C(e,t));Ke.displayName="MarkdownUl";var Ze=memo(({className:e,node:t,...n})=>jsx("hr",{className:f("my-6 border-border",e),"data-streamdown":"horizontal-rule",...n}),(e,t)=>C(e,t));Ze.displayName="MarkdownHr";var Ge=memo(({children:e,className:t,node:n,...o})=>jsx("span",{className:f("font-semibold",t),"data-streamdown":"strong",...o,children:e}),(e,t)=>C(e,t));Ge.displayName="MarkdownStrong";var Ye=memo(({children:e,className:t,href:n,node:o,...a})=>{let r=n==="streamdown:incomplete-link";return jsx("a",{className:f("wrap-anywhere font-medium text-primary underline",t),"data-incomplete":r,"data-streamdown":"link",href:n,rel:"noreferrer",target:"_blank",...a,children:e})},(e,t)=>C(e,t)&&e.href===t.href);Ye.displayName="MarkdownA";var Qe=memo(({children:e,className:t,node:n,...o})=>jsx("h1",{className:f("mt-6 mb-2 font-semibold text-3xl",t),"data-streamdown":"heading-1",...o,children:e}),(e,t)=>C(e,t));Qe.displayName="MarkdownH1";var et=memo(({children:e,className:t,node:n,...o})=>jsx("h2",{className:f("mt-6 mb-2 font-semibold text-2xl",t),"data-streamdown":"heading-2",...o,children:e}),(e,t)=>C(e,t));et.displayName="MarkdownH2";var tt=memo(({children:e,className:t,node:n,...o})=>jsx("h3",{className:f("mt-6 mb-2 font-semibold text-xl",t),"data-streamdown":"heading-3",...o,children:e}),(e,t)=>C(e,t));tt.displayName="MarkdownH3";var ot=memo(({children:e,className:t,node:n,...o})=>jsx("h4",{className:f("mt-6 mb-2 font-semibold text-lg",t),"data-streamdown":"heading-4",...o,children:e}),(e,t)=>C(e,t));ot.displayName="MarkdownH4";var nt=memo(({children:e,className:t,node:n,...o})=>jsx("h5",{className:f("mt-6 mb-2 font-semibold text-base",t),"data-streamdown":"heading-5",...o,children:e}),(e,t)=>C(e,t));nt.displayName="MarkdownH5";var rt=memo(({children:e,className:t,node:n,...o})=>jsx("h6",{className:f("mt-6 mb-2 font-semibold text-sm",t),"data-streamdown":"heading-6",...o,children:e}),(e,t)=>C(e,t));rt.displayName="MarkdownH6";var st=memo(({children:e,className:t,node:n,...o})=>{let{controls:a}=useContext(P),r=ue(a,"table");return jsx(Xe,{className:t,"data-streamdown":"table-wrapper",showControls:r,...o,children:e})},(e,t)=>C(e,t));st.displayName="MarkdownTable";var at=memo(({children:e,className:t,node:n,...o})=>jsx("thead",{className:f("bg-muted/80",t),"data-streamdown":"table-header",...o,children:e}),(e,t)=>C(e,t));at.displayName="MarkdownThead";var it=memo(({children:e,className:t,node:n,...o})=>jsx("tbody",{className:f("divide-y divide-border bg-muted/40",t),"data-streamdown":"table-body",...o,children:e}),(e,t)=>C(e,t));it.displayName="MarkdownTbody";var lt=memo(({children:e,className:t,node:n,...o})=>jsx("tr",{className:f("border-border border-b",t),"data-streamdown":"table-row",...o,children:e}),(e,t)=>C(e,t));lt.displayName="MarkdownTr";var ct=memo(({children:e,className:t,node:n,...o})=>jsx("th",{className:f("whitespace-nowrap px-4 py-2 text-left font-semibold text-sm",t),"data-streamdown":"table-header-cell",...o,children:e}),(e,t)=>C(e,t));ct.displayName="MarkdownTh";var dt=memo(({children:e,className:t,node:n,...o})=>jsx("td",{className:f("px-4 py-2 text-sm",t),"data-streamdown":"table-cell",...o,children:e}),(e,t)=>C(e,t));dt.displayName="MarkdownTd";var mt=memo(({children:e,className:t,node:n,...o})=>jsx("blockquote",{className:f("my-4 border-muted-foreground/30 border-l-4 pl-4 text-muted-foreground italic",t),"data-streamdown":"blockquote",...o,children:e}),(e,t)=>C(e,t));mt.displayName="MarkdownBlockquote";var pt=memo(({children:e,className:t,node:n,...o})=>jsx("sup",{className:f("text-sm",t),"data-streamdown":"superscript",...o,children:e}),(e,t)=>C(e,t));pt.displayName="MarkdownSup";var ut=memo(({children:e,className:t,node:n,...o})=>jsx("sub",{className:f("text-sm",t),"data-streamdown":"subscript",...o,children:e}),(e,t)=>C(e,t));ut.displayName="MarkdownSub";var ft=memo(({children:e,className:t,node:n,...o})=>{if("data-footnotes"in o){let r=l=>{var p,g;if(!isValidElement(l))return  false;let i=Array.isArray(l.props.children)?l.props.children:[l.props.children],d=false,m=false;for(let u of i)if(u){if(typeof u=="string")u.trim()!==""&&(d=true);else if(isValidElement(u))if(((p=u.props)==null?void 0:p["data-footnote-backref"])!==void 0)m=true;else {let b=Array.isArray(u.props.children)?u.props.children:[u.props.children];for(let y of b){if(typeof y=="string"&&y.trim()!==""){d=true;break}if(isValidElement(y)&&((g=y.props)==null?void 0:g["data-footnote-backref"])===void 0){d=true;break}}}}return m&&!d},c=Array.isArray(e)?e.map(l=>{if(!isValidElement(l))return l;if(l.type===fe){let d=(Array.isArray(l.props.children)?l.props.children:[l.props.children]).filter(m=>!r(m));return d.length===0?null:{...l,props:{...l.props,children:d}}}return l}):e;return (Array.isArray(c)?c.some(l=>l!==null):c!==null)?jsx("section",{className:t,...o,children:c}):null}return jsx("section",{className:t,...o,children:e})},(e,t)=>C(e,t));ft.displayName="MarkdownSection";var Io=({node:e,className:t,children:n,...o})=>{var m,p,g;let a=((m=e==null?void 0:e.position)==null?void 0:m.start.line)===((p=e==null?void 0:e.position)==null?void 0:p.end.line),{mermaid:r,controls:c}=useContext(P);if(a)return jsx("code",{className:f("rounded bg-muted px-1.5 py-0.5 font-mono text-sm",t),"data-streamdown":"inline-code",...o,children:n});let s=t==null?void 0:t.match(Do),l=(g=s==null?void 0:s.at(1))!=null?g:"",i="";if(isValidElement(n)&&n.props&&typeof n.props=="object"&&"children"in n.props&&typeof n.props.children=="string"?i=n.props.children:typeof n=="string"&&(i=n),l==="mermaid"){let u=ue(c,"mermaid"),b=oe(c,"download"),y=oe(c,"copy"),k=oe(c,"fullscreen"),T=oe(c,"panZoom"),M=u&&(b||y||k);return jsx(Suspense,{fallback:jsx(de,{}),children:jsxs("div",{className:f("group relative my-4 h-auto rounded-xl border p-4",t),"data-streamdown":"mermaid-block",children:[M?jsxs("div",{className:"flex items-center justify-end gap-2",children:[b?jsx(Ee,{chart:i,config:r==null?void 0:r.config}):null,y?jsx(le,{code:i}):null,k?jsx(je,{chart:i,config:r==null?void 0:r.config}):null]}):null,jsx(Eo,{chart:i,config:r==null?void 0:r.config,showControls:T})]})})}let d=ue(c,"code");return jsx(Suspense,{fallback:jsx(de,{}),children:jsx(So,{className:f("overflow-x-auto border-border border-t",t),code:i,language:l,children:d?jsxs(Fragment,{children:[jsx(Pe,{code:i,language:l}),jsx(le,{})]}):null})})},gt=memo(Io,(e,t)=>e.className===t.className&&ne(e.node,t.node));gt.displayName="MarkdownCode";var bt=memo(Ne,(e,t)=>e.className===t.className&&ne(e.node,t.node));bt.displayName="MarkdownImg";var ht=memo(({children:e,className:t,node:n,...o})=>{var c;let r=(Array.isArray(e)?e:[e]).filter(s=>s!=null&&s!=="");return r.length===1&&isValidElement(r[0])&&((c=r[0].props.node)==null?void 0:c.tagName)==="img"?jsx(Fragment,{children:e}):jsx("p",{className:t,...o,children:e})},(e,t)=>C(e,t));ht.displayName="MarkdownParagraph";var yt={ol:fe,li:Ue,ul:Ke,hr:Ze,strong:Ge,a:Ye,h1:Qe,h2:et,h3:tt,h4:ot,h5:nt,h6:rt,table:st,thead:at,tbody:it,tr:lt,th:ct,td:dt,blockquote:mt,code:gt,img:bt,pre:({children:e})=>e,sup:pt,sub:ut,p:ht,section:ft};var kt=[],xt={allowDangerousHtml:true},re=new WeakMap,ge=class{constructor(){this.cache=new Map;this.keyCache=new WeakMap;this.maxSize=100;}generateCacheKey(t){let n=this.keyCache.get(t);if(n)return n;let o=t.rehypePlugins,a=t.remarkPlugins,r=t.remarkRehypeOptions;if(!(o||a||r)){let m="default";return this.keyCache.set(t,m),m}let c=m=>{if(!m||m.length===0)return "";let p="";for(let g=0;g<m.length;g+=1){let u=m[g];if(g>0&&(p+=","),Array.isArray(u)){let[b,y]=u;if(typeof b=="function"){let k=re.get(b);k||(k=b.name,re.set(b,k)),p+=k;}else p+=String(b);p+=":",p+=JSON.stringify(y);}else if(typeof u=="function"){let b=re.get(u);b||(b=u.name,re.set(u,b)),p+=b;}else p+=String(u);}return p},s=c(o),l=c(a),i=r?JSON.stringify(r):"",d=`${l}::${s}::${i}`;return this.keyCache.set(t,d),d}get(t){let n=this.generateCacheKey(t),o=this.cache.get(n);return o&&(this.cache.delete(n),this.cache.set(n,o)),o}set(t,n){let o=this.generateCacheKey(t);if(this.cache.size>=this.maxSize){let a=this.cache.keys().next().value;a&&this.cache.delete(a);}this.cache.set(o,n);}clear(){this.cache.clear();}},vt=new ge,be=e=>{let t=$o(e),n=e.children||"";return Fo(t.runSync(t.parse(n),n),e)},$o=e=>{let t=vt.get(e);if(t)return t;let n=zo(e);return vt.set(e,n),n},zo=e=>{let t=e.rehypePlugins||kt,n=e.remarkPlugins||kt,o=e.remarkRehypeOptions?{...xt,...e.remarkRehypeOptions}:xt;return unified().use(Oo).use(n).use(Ho,o).use(t)},Fo=(e,t)=>toJsxRuntime(e,{Fragment:Fragment,components:t.components,ignoreInvalidStyle:true,jsx:jsx,jsxs:jsxs,passKeys:true,passNode:true});var Xo=/\[\^[^\]\s]{1,200}\](?!:)/,_o=/\[\^[^\]\s]{1,200}\]:/,Jo=/<\/(\w+)>/,Wo=/<(\w+)[\s>]/,he=e=>{let t=0;for(;t<e.length&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t+=1;return t+1<e.length&&e[t]==="$"&&e[t+1]==="$"},Uo=e=>{let t=e.length-1;for(;t>=0&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t-=1;return t>=1&&e[t]==="$"&&e[t-1]==="$"},ye=e=>{let t=0;for(let n=0;n<e.length-1;n+=1)e[n]==="$"&&e[n+1]==="$"&&(t+=1,n+=1);return t},we=e=>{let t=Xo.test(e),n=_o.test(e);if(t||n)return [e];let o=Lexer.lex(e,{gfm:true}),a=[],r=[];for(let c of o){let s=c.raw,l=a.length;if(r.length>0){if(a[l-1]+=s,c.type==="html"){let d=s.match(Jo);if(d){let m=d[1];r.at(-1)===m&&r.pop();}}continue}if(c.type==="html"&&c.block){let d=s.match(Wo);if(d){let m=d[1];s.includes(`</${m}>`)||r.push(m);}}if(s.trim()==="$$"&&l>0){let d=a[l-1],m=he(d),p=ye(d);if(m&&p%2===1){a[l-1]=d+s;continue}}if(l>0&&Uo(s)){let d=a[l-1],m=he(d),p=ye(d),g=ye(s);if(m&&p%2===1&&!he(s)&&g===1){a[l-1]=d+s;continue}}a.push(s);}return a};var Ct={name:"streamdown",version:"1.6.10",type:"module",main:"./dist/index.js",module:"./dist/index.js",types:"./dist/index.d.ts",exports:{".":{types:"./dist/index.d.ts",import:"./dist/index.js",require:"./dist/index.cjs"}},files:["dist","README.md"],homepage:"https://streamdown.ai",repository:{type:"git",url:"git+https://github.com/vercel/streamdown.git",directory:"packages/streamdown"},scripts:{build:"tsup",postbuild:"node scripts/postbuild.js",test:"vitest run","test:ui":"vitest --ui run","test:coverage":"vitest --coverage run",bench:"vitest bench --run > results.txt","bench:ui":"vitest bench --ui --run"},author:"Hayden Bleasel <hayden.bleasel@vercel.com>",license:"Apache-2.0",description:"A drop-in replacement for react-markdown, designed for AI-powered streaming.",devDependencies:{"@testing-library/jest-dom":"^6.9.1","@testing-library/react":"^16.3.0","@types/hast":"^3.0.4","@types/react":"^19.2.7","@types/react-dom":"^19.2.3","@vitejs/plugin-react":"^5.1.2","@vitest/coverage-v8":"^4.0.15",jsdom:"^27.3.0",react:"^19.2.1","react-dom":"^19.2.1","react-markdown":"^10.1.0",tsup:"^8.5.1",vitest:"^4.0.15"},peerDependencies:{react:"^18.0.0 || ^19.0.0"},dependencies:{clsx:"^2.1.1","hast-util-to-jsx-runtime":"^2.3.6","html-url-attributes":"^3.0.1","lucide-react":"^0.560.0",marked:"^17.0.1",mermaid:"^11.12.2","rehype-harden":"^1.1.7","rehype-katex":"^7.0.1","rehype-raw":"^7.0.0","rehype-sanitize":"^6.0.0","remark-cjk-friendly":"^1.2.3","remark-cjk-friendly-gfm-strikethrough":"^1.2.3","remark-gfm":"^4.0.1","remark-math":"^6.0.0","remark-parse":"^11.0.0","remark-rehype":"^11.1.2",remend:"workspace:*",shiki:"^3.19.0","tailwind-merge":"^3.4.0",unified:"^11.0.5","unist-util-visit":"^5.0.0"}};var Et={javascript:Yo,typescript:rn,jsx:en,tsx:nn,html:Go,css:Zo,json:Qo,bash:Tt,shellscript:Rt,shell:Rt,sh:Tt,yaml:St,yml:St,toml:on,python:Nt,py:Nt,markdown:Pt,md:Pt,sql:tn,go:Mt,golang:Mt},sn=e=>e in Et;var yn=/[^$]\$[^$]/,wn=/^\$[^$]/,kn=/[^$]\$$/,xn={raw:pn,sanitize:[un,{}],katex:[ke,{errorColor:"var(--color-muted-foreground)"}],harden:[harden,{allowedImagePrefixes:["*"],allowedLinkPrefixes:["*"],allowedProtocols:["*"],defaultOrigin:void 0,allowDataImages:true}]},vn={gfm:[bn,{}],math:[xe,{singleDollarTextMath:false}],cjkFriendly:[fn,{}],cjkFriendlyGfmStrikethrough:[gn,{}]},Cn=Object.values(xn),Tn=Object.values(vn),Mn={block:" \u258B",circle:" \u25CF"},Pn={shikiTheme:["github-light","github-dark"],controls:true,isAnimating:false,mode:"streaming",mermaid:void 0,cdnUrl:void 0},P=createContext(Pn),Lt=memo(({content:e,...t})=>jsx(be,{...t,children:e}),(e,t)=>{if(e.content!==t.content||e.index!==t.index)return  false;if(e.components!==t.components){let n=Object.keys(e.components||{}),o=Object.keys(t.components||{});if(n.length!==o.length||n.some(a=>{var r,c;return ((r=e.components)==null?void 0:r[a])!==((c=t.components)==null?void 0:c[a])}))return  false}return !(e.rehypePlugins!==t.rehypePlugins||e.remarkPlugins!==t.remarkPlugins)});Lt.displayName="Block";var Nn=["github-light","github-dark"],Rn=e=>Array.isArray(e)&&e.some(t=>Array.isArray(t)?t[0]===ke:t===ke),Sn=e=>{if(!Array.isArray(e))return  false;let t=e.find(n=>Array.isArray(n)?n[0]===xe:n===xe);return t&&Array.isArray(t)&&t[1]?t[1].singleDollarTextMath===true:false},En=(e,t)=>{let n=e.includes("$$"),o=t&&(yn.test(e)||wn.test(e)||kn.test(e));return n||o},Dn=/^\^/,In=()=>{let e=Ct.dependencies["rehype-katex"].replace(Dn,"").split(".")[0],n={7:"0.16.22"}[e]||"0.16.22",o=document.createElement("link");o.rel="stylesheet",o.href=`/cdn/katex/${n}/katex.min.css`,document.head.appendChild(o);},Ln=memo(({children:e,mode:t="streaming",parseIncompleteMarkdown:n=true,components:o,rehypePlugins:a=Cn,remarkPlugins:r=Tn,className:c,shikiTheme:s=Nn,mermaid:l,controls:i=true,isAnimating:d=false,BlockComponent:m=Lt,parseMarkdownIntoBlocksFn:p=we,caret:g,cdnUrl:u,remend:b,...y})=>{let k=useId(),[T,M]=useTransition(),[v,R]=useState([]),S=useMemo(()=>typeof e!="string"?"":t==="streaming"&&n?hn(e,b):e,[e,t,n,b]),E=useMemo(()=>p(S),[S,p]);useEffect(()=>{t==="streaming"?M(()=>{R(E);}):R(E);},[E,t]);let I=t==="streaming"?v:E,$=useMemo(()=>I.map((N,j)=>`${k}-${j}`),[I.length,k]),B=useMemo(()=>({shikiTheme:s,controls:i,isAnimating:d,mode:t,mermaid:l,cdnUrl:u}),[s,i,d,t,l,u]),A=useMemo(()=>({...yt,...o}),[o]);useEffect(()=>{if(!Rn(a))return;let j=Sn(r);En(typeof e=="string"?e:"",j)&&In();},[a,r,e]);let w=useMemo(()=>g&&d?{"--streamdown-caret":`"${Mn[g]}"`}:void 0,[g,d]);return t==="static"?jsx(P.Provider,{value:B,children:jsx("div",{className:f("space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0",c),children:jsx(be,{components:A,rehypePlugins:a,remarkPlugins:r,...y,children:e})})}):jsx(P.Provider,{value:B,children:jsx("div",{className:f("space-y-4 whitespace-normal *:first:mt-0 *:last:mb-0",g?"*:last:after:inline *:last:after:align-baseline *:last:after:content-(--streamdown-caret)":null,c),style:w,children:I.map((N,j)=>jsx(m,{components:A,content:N,index:j,rehypePlugins:a,remarkPlugins:r,shouldParseIncompleteMarkdown:n,...y},$[j]))})})},(e,t)=>e.children===t.children&&e.shikiTheme===t.shikiTheme&&e.isAnimating===t.isAnimating&&e.mode===t.mode);Ln.displayName="Streamdown";var Ot=({children:e,className:t,minZoom:n=.5,maxZoom:o=3,zoomStep:a=.1,showControls:r=true,initialZoom:c=1,fullscreen:s=false})=>{let l=useRef(null),i=useRef(null),[d,m]=useState(c),[p,g]=useState({x:0,y:0}),[u,b]=useState(false),[y,k]=useState({x:0,y:0}),[T,M]=useState({x:0,y:0}),v=useCallback(w=>{m(N=>Math.max(n,Math.min(o,N+w)));},[n,o]),R=useCallback(()=>{v(a);},[v,a]),S=useCallback(()=>{v(-a);},[v,a]),E=useCallback(()=>{m(c),g({x:0,y:0});},[c]),I=useCallback(w=>{w.preventDefault();let N=w.deltaY>0?-a:a;v(N);},[v,a]),$=useCallback(w=>{if(w.button!==0||w.isPrimary===false)return;b(true),k({x:w.clientX,y:w.clientY}),M(p);let N=w.currentTarget;N instanceof HTMLElement&&N.setPointerCapture(w.pointerId);},[p]),B=useCallback(w=>{if(!u)return;w.preventDefault();let N=w.clientX-y.x,j=w.clientY-y.y;g({x:T.x+N,y:T.y+j});},[u,y,T]),A=useCallback(w=>{b(false);let N=w.currentTarget;N instanceof HTMLElement&&N.releasePointerCapture(w.pointerId);},[]);return useEffect(()=>{let w=l.current;if(w)return w.addEventListener("wheel",I,{passive:false}),()=>{w.removeEventListener("wheel",I);}},[I]),useEffect(()=>{let w=i.current;if(w&&u)return document.body.style.userSelect="none",w.addEventListener("pointermove",B,{passive:false}),w.addEventListener("pointerup",A),w.addEventListener("pointercancel",A),()=>{document.body.style.userSelect="",w.removeEventListener("pointermove",B),w.removeEventListener("pointerup",A),w.removeEventListener("pointercancel",A);}},[u,B,A]),jsxs("div",{className:f("relative flex flex-col",s?"h-full w-full":"min-h-28 w-full",t),ref:l,style:{cursor:u?"grabbing":"grab"},children:[r?jsxs("div",{className:f("absolute z-10 flex flex-col gap-1 rounded-md border border-border bg-background/90 p-1 shadow-sm backdrop-blur-sm",s?"bottom-4 left-4":"bottom-2 left-2"),children:[jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:d>=o,onClick:R,title:"Zoom in",type:"button",children:jsx(ZoomInIcon,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:d<=n,onClick:S,title:"Zoom out",type:"button",children:jsx(ZoomOutIcon,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",onClick:E,title:"Reset zoom and pan",type:"button",children:jsx(RotateCcwIcon,{size:16})})]}):null,jsx("div",{className:f("flex-1 origin-center transition-transform duration-150 ease-out",s?"flex h-full w-full items-center justify-center":"flex w-full items-center justify-center"),onPointerDown:$,ref:i,role:"application",style:{transform:`translate(${p.x}px, ${p.y}px) scale(${d})`,transformOrigin:"center center",touchAction:"none",willChange:"transform"},children:e})]})};var Le=({chart:e,className:t,config:n,fullscreen:o=false,showControls:a=true})=>{let[r,c]=useState(null),[s,l]=useState(false),[i,d]=useState(""),[m,p]=useState(""),[g,u]=useState(0),{mermaid:b}=useContext(P),y=b==null?void 0:b.errorComponent,{shouldRender:k,containerRef:T}=ve({immediate:o});if(useEffect(()=>{if(!k)return;(async()=>{try{c(null),l(!0);let R=await Z(n),S=e.split("").reduce(($,B)=>($<<5)-$+B.charCodeAt(0)|0,0),E=`mermaid-${Math.abs(S)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:I}=await R.render(E,e);d(I),p(I);}catch(R){if(!(m||i)){let S=R instanceof Error?R.message:"Failed to render Mermaid chart";c(S);}}finally{l(false);}})();},[e,n,g,k]),!(k||i||m))return jsx("div",{className:f("my-4 min-h-[200px]",t),ref:T});if(s&&!i&&!m)return jsx("div",{className:f("my-4 flex justify-center p-4",t),ref:T,children:jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-current border-b-2"}),jsx("span",{className:"text-sm",children:"Loading diagram..."})]})});if(r&&!i&&!m){let v=()=>u(R=>R+1);return y?jsx("div",{ref:T,children:jsx(y,{chart:e,error:r,retry:v})}):jsxs("div",{className:f("rounded-lg border border-red-200 bg-red-50 p-4",t),ref:T,children:[jsxs("p",{className:"font-mono text-red-700 text-sm",children:["Mermaid Error: ",r]}),jsxs("details",{className:"mt-2",children:[jsx("summary",{className:"cursor-pointer text-red-600 text-xs",children:"Show Code"}),jsx("pre",{className:"mt-2 overflow-x-auto rounded bg-red-100 p-2 text-red-800 text-xs",children:e})]})]})}let M=i||m;return jsx("div",{className:"size-full",ref:T,children:jsx(Ot,{className:f(o?"size-full overflow-hidden":"my-4 overflow-hidden",t),fullscreen:o,maxZoom:3,minZoom:.5,showControls:a,zoomStep:.1,children:jsx("div",{"aria-label":"Mermaid chart",className:f("flex justify-center",o?"size-full items-center":null),dangerouslySetInnerHTML:{__html:M},role:"img"})})})};
export{f as a,Wt as b,Le as c,Et as d,sn as e,Ct as f,we as g,xn as h,vn as i,P as j,Lt as k,Ln as l};