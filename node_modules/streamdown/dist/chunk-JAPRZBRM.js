"use client";
import {createContext,lazy,memo,useContext,isValidElement,useMemo,useId,useTransition,useState,useEffect,Suspense,useRef,useCallback}from'react';import {harden}from'rehype-harden';import we from'rehype-katex';import qo from'rehype-raw';import $o from'rehype-sanitize';import zo from'remark-cjk-friendly';import Xo from'remark-cjk-friendly-gfm-strikethrough';import Fo from'remark-gfm';import ke from'remark-math';import Jo from'remend';import {DownloadIcon,CheckIcon,CopyIcon,Maximize2Icon,XIcon,Loader2Icon,ZoomInIcon,ZoomOutIcon,RotateCcwIcon}from'lucide-react';import {clsx}from'clsx';import {twMerge}from'tailwind-merge';import {jsx,jsxs,Fragment}from'react/jsx-runtime';import {toJsxRuntime}from'hast-util-to-jsx-runtime';import xo from'remark-parse';import Co from'remark-rehype';import {unified}from'unified';import {Lexer}from'marked';var u=(...e)=>twMerge(clsx(e)),R=(e,t,n)=>{let o=typeof t=="string"?new Blob([t],{type:n}):t,s=URL.createObjectURL(o),r=document.createElement("a");r.href=s,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s);};var Dt=createContext({code:""}),U=()=>useContext(Dt);var ie=({onCopy:e,onError:t,timeout:n=2e3,children:o,className:s,code:r,...i})=>{let[a,d]=useState(false),c=useRef(0),{code:m}=U(),{isAnimating:l}=useContext(C),p=r!=null?r:m,g=async()=>{var b;if(typeof window=="undefined"||!((b=navigator==null?void 0:navigator.clipboard)!=null&&b.writeText)){t==null||t(new Error("Clipboard API not available"));return}try{a||(await navigator.clipboard.writeText(p),d(!0),e==null||e(),c.current=window.setTimeout(()=>d(!1),n));}catch(w){t==null||t(w);}};useEffect(()=>()=>{window.clearTimeout(c.current);},[]);let f=a?CheckIcon:CopyIcon;return jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",s),"data-streamdown":"code-block-copy-button",disabled:l,onClick:g,title:"Copy Code",type:"button",...i,children:o!=null?o:jsx(f,{size:14})})};var xe={"1c":"1c","1c-query":"1cq",abap:"abap","actionscript-3":"as",ada:"ada",adoc:"adoc","angular-html":"html","angular-ts":"ts",apache:"conf",apex:"cls",apl:"apl",applescript:"applescript",ara:"ara",asciidoc:"adoc",asm:"asm",astro:"astro",awk:"awk",ballerina:"bal",bash:"sh",bat:"bat",batch:"bat",be:"be",beancount:"beancount",berry:"berry",bibtex:"bib",bicep:"bicep",blade:"blade.php",bsl:"bsl",c:"c","c#":"cs","c++":"cpp",cadence:"cdc",cairo:"cairo",cdc:"cdc",clarity:"clar",clj:"clj",clojure:"clj","closure-templates":"soy",cmake:"cmake",cmd:"cmd",cobol:"cob",codeowners:"CODEOWNERS",codeql:"ql",coffee:"coffee",coffeescript:"coffee","common-lisp":"lisp",console:"sh",coq:"v",cpp:"cpp",cql:"cql",crystal:"cr",cs:"cs",csharp:"cs",css:"css",csv:"csv",cue:"cue",cypher:"cql",d:"d",dart:"dart",dax:"dax",desktop:"desktop",diff:"diff",docker:"dockerfile",dockerfile:"dockerfile",dotenv:"env","dream-maker":"dm",edge:"edge",elisp:"el",elixir:"ex",elm:"elm","emacs-lisp":"el",erb:"erb",erl:"erl",erlang:"erl",f:"f","f#":"fs",f03:"f03",f08:"f08",f18:"f18",f77:"f77",f90:"f90",f95:"f95",fennel:"fnl",fish:"fish",fluent:"ftl",for:"for","fortran-fixed-form":"f","fortran-free-form":"f90",fs:"fs",fsharp:"fs",fsl:"fsl",ftl:"ftl",gdresource:"tres",gdscript:"gd",gdshader:"gdshader",genie:"gs",gherkin:"feature","git-commit":"gitcommit","git-rebase":"gitrebase",gjs:"js",gleam:"gleam","glimmer-js":"js","glimmer-ts":"ts",glsl:"glsl",gnuplot:"plt",go:"go",gql:"gql",graphql:"graphql",groovy:"groovy",gts:"gts",hack:"hack",haml:"haml",handlebars:"hbs",haskell:"hs",haxe:"hx",hbs:"hbs",hcl:"hcl",hjson:"hjson",hlsl:"hlsl",hs:"hs",html:"html","html-derivative":"html",http:"http",hxml:"hxml",hy:"hy",imba:"imba",ini:"ini",jade:"jade",java:"java",javascript:"js",jinja:"jinja",jison:"jison",jl:"jl",js:"js",json:"json",json5:"json5",jsonc:"jsonc",jsonl:"jsonl",jsonnet:"jsonnet",jssm:"jssm",jsx:"jsx",julia:"jl",kotlin:"kt",kql:"kql",kt:"kt",kts:"kts",kusto:"kql",latex:"tex",lean:"lean",lean4:"lean",less:"less",liquid:"liquid",lisp:"lisp",lit:"lit",llvm:"ll",log:"log",logo:"logo",lua:"lua",luau:"luau",make:"mak",makefile:"mak",markdown:"md",marko:"marko",matlab:"m",md:"md",mdc:"mdc",mdx:"mdx",mediawiki:"wiki",mermaid:"mmd",mips:"s",mipsasm:"s",mmd:"mmd",mojo:"mojo",move:"move",nar:"nar",narrat:"narrat",nextflow:"nf",nf:"nf",nginx:"conf",nim:"nim",nix:"nix",nu:"nu",nushell:"nu",objc:"m","objective-c":"m","objective-cpp":"mm",ocaml:"ml",pascal:"pas",perl:"pl",perl6:"p6",php:"php",plsql:"pls",po:"po",polar:"polar",postcss:"pcss",pot:"pot",potx:"potx",powerquery:"pq",powershell:"ps1",prisma:"prisma",prolog:"pl",properties:"properties",proto:"proto",protobuf:"proto",ps:"ps",ps1:"ps1",pug:"pug",puppet:"pp",purescript:"purs",py:"py",python:"py",ql:"ql",qml:"qml",qmldir:"qmldir",qss:"qss",r:"r",racket:"rkt",raku:"raku",razor:"cshtml",rb:"rb",reg:"reg",regex:"regex",regexp:"regexp",rel:"rel",riscv:"s",rs:"rs",rst:"rst",ruby:"rb",rust:"rs",sas:"sas",sass:"sass",scala:"scala",scheme:"scm",scss:"scss",sdbl:"sdbl",sh:"sh",shader:"shader",shaderlab:"shader",shell:"sh",shellscript:"sh",shellsession:"sh",smalltalk:"st",solidity:"sol",soy:"soy",sparql:"rq",spl:"spl",splunk:"spl",sql:"sql","ssh-config":"config",stata:"do",styl:"styl",stylus:"styl",svelte:"svelte",swift:"swift","system-verilog":"sv",systemd:"service",talon:"talon",talonscript:"talon",tasl:"tasl",tcl:"tcl",templ:"templ",terraform:"tf",tex:"tex",tf:"tf",tfvars:"tfvars",toml:"toml",ts:"ts","ts-tags":"ts",tsp:"tsp",tsv:"tsv",tsx:"tsx",turtle:"ttl",twig:"twig",typ:"typ",typescript:"ts",typespec:"tsp",typst:"typ",v:"v",vala:"vala",vb:"vb",verilog:"v",vhdl:"vhdl",vim:"vim",viml:"vim",vimscript:"vim",vue:"vue","vue-html":"html","vue-vine":"vine",vy:"vy",vyper:"vy",wasm:"wasm",wenyan:"wy",wgsl:"wgsl",wiki:"wiki",wikitext:"wiki",wit:"wit",wl:"wl",wolfram:"wl",xml:"xml",xsl:"xsl",yaml:"yaml",yml:"yml",zenscript:"zs",zig:"zig",zsh:"zsh",\u6587\u8A00:"wy"},Me=({onDownload:e,onError:t,language:n,children:o,className:s,code:r,...i})=>{let{code:a}=U(),{isAnimating:d}=useContext(C),c=r!=null?r:a,l=`file.${n&&n in xe?xe[n]:"txt"}`,p="text/plain",g=()=>{try{R(l,c,p),e==null||e();}catch(f){t==null||t(f);}};return jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",s),"data-streamdown":"code-block-download-button",disabled:d,onClick:g,title:"Download file",type:"button",...i,children:o!=null?o:jsx(DownloadIcon,{size:14})})};var de=()=>jsxs("div",{className:"w-full divide-y divide-border overflow-hidden rounded-xl border border-border",children:[jsx("div",{className:"h-[46px] w-full bg-muted/80"}),jsx("div",{className:"flex w-full items-center justify-center p-4",children:jsx(Loader2Icon,{className:"size-4 animate-spin"})})]});var Jt=/\.[^/.]+$/,Pe=({node:e,className:t,src:n,alt:o,...s})=>{let r=async()=>{if(n)try{let a=await(await fetch(n)).blob(),c=new URL(n,window.location.origin).pathname.split("/").pop()||"",m=c.split(".").pop(),l=c.includes(".")&&m!==void 0&&m.length<=4,p="";if(l)p=c;else {let g=a.type,f="png";g.includes("jpeg")||g.includes("jpg")?f="jpg":g.includes("png")?f="png":g.includes("svg")?f="svg":g.includes("gif")?f="gif":g.includes("webp")&&(f="webp"),p=`${(o||c||"image").replace(Jt,"")}.${f}`;}R(p,a,a.type);}catch(i){console.error("Failed to download image:",i);}};return n?jsxs("div",{className:"group relative my-4 inline-block","data-streamdown":"image-wrapper",children:[jsx("img",{alt:o,className:u("max-w-full rounded-lg",t),"data-streamdown":"image",src:n,...s}),jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-lg bg-black/10 group-hover:block"}),jsx("button",{className:u("absolute right-2 bottom-2 flex h-8 w-8 cursor-pointer items-center justify-center rounded-md border border-border bg-background/90 shadow-sm backdrop-blur-sm transition-all duration-200 hover:bg-background","opacity-0 group-hover:opacity-100"),onClick:r,title:"Download image",type:"button",children:jsx(DownloadIcon,{size:14})})]}):null};var _=async e=>{let n={...{startOnLoad:false,theme:"default",securityLevel:"strict",fontFamily:"monospace",suppressErrorRendering:true},...e},s=(await import('mermaid')).default;return s.initialize(n),s},Te=(e,t)=>{var o;let n=(o=void 0)!=null?o:5;return new Promise((s,r)=>{let i="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),a=new Image;a.crossOrigin="anonymous",a.onload=()=>{let d=document.createElement("canvas"),c=a.width*n,m=a.height*n;d.width=c,d.height=m;let l=d.getContext("2d");if(!l){r(new Error("Failed to create 2D canvas context for PNG export"));return}l.drawImage(a,0,0,c,m),d.toBlob(p=>{if(!p){r(new Error("Failed to create PNG blob"));return}s(p);},"image/png");},a.onerror=()=>r(new Error("Failed to load SVG image")),a.src=i;})};var Se=({chart:e,children:t,className:n,onDownload:o,config:s,onError:r})=>{let[i,a]=useState(false),d=useRef(null),{isAnimating:c}=useContext(C),m=async l=>{try{if(l==="mmd"){R("diagram.mmd",e,"text/plain"),a(!1),o==null||o(l);return}let p=await _(s),g=e.split("").reduce((w,v)=>(w<<5)-w+v.charCodeAt(0)|0,0),f=`mermaid-${Math.abs(g)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:b}=await p.render(f,e);if(!b){r==null||r(new Error("SVG not found. Please wait for the diagram to render."));return}if(l==="svg"){R("diagram.svg",b,"image/svg+xml"),a(!1),o==null||o(l);return}if(l==="png"){let w=await Te(b);R("diagram.png",w,"image/png"),o==null||o(l),a(!1);return}}catch(p){r==null||r(p);}};return useEffect(()=>{let l=p=>{d.current&&!d.current.contains(p.target)&&a(false);};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l);}},[]),jsxs("div",{className:"relative",ref:d,children:[jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",n),disabled:c,onClick:()=>a(!i),title:"Download diagram",type:"button",children:t!=null?t:jsx(DownloadIcon,{size:14})}),i&&jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>m("svg"),title:"Download diagram as SVG",type:"button",children:"SVG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>m("png"),title:"Download diagram as PNG",type:"button",children:"PNG"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>m("mmd"),title:"Download diagram as MMD",type:"button",children:"MMD"})]})]})};var J=0,to=()=>{J+=1,J===1&&(document.body.style.overflow="hidden");},oo=()=>{J=Math.max(0,J-1),J===0&&(document.body.style.overflow="");},De=({chart:e,config:t,onFullscreen:n,onExit:o,className:s,...r})=>{let[i,a]=useState(false),{isAnimating:d,controls:c}=useContext(C),m=(()=>{if(typeof c=="boolean")return c;let p=c.mermaid;return p===false?false:p===true||p===void 0?true:p.panZoom!==false})(),l=()=>{a(!i);};return useEffect(()=>{if(i){to();let p=g=>{g.key==="Escape"&&a(false);};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),oo();}}},[i]),useEffect(()=>{i?n==null||n():o&&o();},[i,n,o]),jsxs(Fragment,{children:[jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",s),disabled:d,onClick:l,title:"View fullscreen",type:"button",...r,children:jsx(Maximize2Icon,{size:14})}),i&&jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/95 backdrop-blur-sm",onClick:l,onKeyDown:p=>{p.key==="Escape"&&l();},role:"button",tabIndex:0,children:[jsx("button",{className:"absolute top-4 right-4 z-10 rounded-md p-2 text-muted-foreground transition-all hover:bg-muted hover:text-foreground",onClick:l,title:"Exit fullscreen",type:"button",children:jsx(XIcon,{size:20})}),jsx("div",{className:"flex h-full w-full items-center justify-center p-4",onClick:p=>p.stopPropagation(),onKeyDown:p=>p.stopPropagation(),role:"presentation",children:jsx(Ee,{chart:e,className:"h-full w-full [&>div]:h-full [&>div]:overflow-hidden [&_svg]:h-auto [&_svg]:w-auto",config:t,fullscreen:true,showControls:m})})]})]})};var Y=e=>{var r,i;let t=[],n=[],o=e.querySelectorAll("thead th");for(let a of o)t.push(((r=a.textContent)==null?void 0:r.trim())||"");let s=e.querySelectorAll("tbody tr");for(let a of s){let d=[],c=a.querySelectorAll("td");for(let m of c)d.push(((i=m.textContent)==null?void 0:i.trim())||"");n.push(d);}return {headers:t,rows:n}},Q=e=>{let{headers:t,rows:n}=e,o=a=>{let d=false,c=false;for(let m=0;m<a.length;m+=1){let l=a[m];if(l==='"'){d=true,c=true;break}(l===","||l===`
`)&&(d=true);}return d?c?`"${a.replace(/"/g,'""')}"`:`"${a}"`:a},s=t.length>0?n.length+1:n.length,r=new Array(s),i=0;t.length>0&&(r[i]=t.map(o).join(","),i+=1);for(let a of n)r[i]=a.map(o).join(","),i+=1;return r.join(`
`)},Le=e=>{let{headers:t,rows:n}=e,o=a=>{let d=false;for(let m=0;m<a.length;m+=1){let l=a[m];if(l==="	"||l===`
`||l==="\r"){d=true;break}}if(!d)return a;let c=[];for(let m=0;m<a.length;m+=1){let l=a[m];l==="	"?c.push("\\t"):l===`
`?c.push("\\n"):l==="\r"?c.push("\\r"):c.push(l);}return c.join("")},s=t.length>0?n.length+1:n.length,r=new Array(s),i=0;t.length>0&&(r[i]=t.map(o).join("	"),i+=1);for(let a of n)r[i]=a.map(o).join("	"),i+=1;return r.join(`
`)},ce=e=>{let t=false;for(let o=0;o<e.length;o+=1){let s=e[o];if(s==="\\"||s==="|"){t=true;break}}if(!t)return e;let n=[];for(let o=0;o<e.length;o+=1){let s=e[o];s==="\\"?n.push("\\\\"):s==="|"?n.push("\\|"):n.push(s);}return n.join("")},Be=e=>{let{headers:t,rows:n}=e;if(t.length===0)return "";let o=new Array(n.length+2),s=0,r=t.map(a=>ce(a));o[s]=`| ${r.join(" | ")} |`,s+=1;let i=new Array(t.length);for(let a=0;a<t.length;a+=1)i[a]="---";o[s]=`| ${i.join(" | ")} |`,s+=1;for(let a of n)if(a.length<t.length){let d=new Array(t.length);for(let c=0;c<t.length;c+=1)d[c]=c<a.length?ce(a[c]):"";o[s]=`| ${d.join(" | ")} |`,s+=1;}else {let d=a.map(c=>ce(c));o[s]=`| ${d.join(" | ")} |`,s+=1;}return o.join(`
`)};var Oe=({children:e,className:t,onCopy:n,onError:o,timeout:s=2e3})=>{let[r,i]=useState(false),[a,d]=useState(false),c=useRef(null),m=useRef(0),{isAnimating:l}=useContext(C),p=async f=>{var b,w;if(typeof window=="undefined"||!((b=navigator==null?void 0:navigator.clipboard)!=null&&b.write)){o==null||o(new Error("Clipboard API not available"));return}try{let v=(w=c.current)==null?void 0:w.closest('[data-streamdown="table-wrapper"]'),T=v==null?void 0:v.querySelector("table");if(!T){o==null||o(new Error("Table not found"));return}let M=Y(T),P=f==="csv"?Q(M):Le(M),j=new ClipboardItem({"text/plain":new Blob([P],{type:"text/plain"}),"text/html":new Blob([T.outerHTML],{type:"text/html"})});await navigator.clipboard.write([j]),d(!0),i(!1),n==null||n(f),m.current=window.setTimeout(()=>d(!1),s);}catch(v){o==null||o(v);}};useEffect(()=>{let f=b=>{c.current&&!c.current.contains(b.target)&&i(false);};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f),window.clearTimeout(m.current);}},[]);let g=a?CheckIcon:CopyIcon;return jsxs("div",{className:"relative",ref:c,children:[jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:l,onClick:()=>i(!r),title:"Copy table",type:"button",children:e!=null?e:jsx(g,{size:14})}),r&&jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("csv"),title:"Copy table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>p("tsv"),title:"Copy table as TSV",type:"button",children:"TSV"})]})]})};var $e=({children:e,className:t,onDownload:n,onError:o})=>{let[s,r]=useState(false),i=useRef(null),{isAnimating:a}=useContext(C),d=c=>{var m;try{let l=(m=i.current)==null?void 0:m.closest('[data-streamdown="table-wrapper"]'),p=l==null?void 0:l.querySelector("table");if(!p){o==null||o(new Error("Table not found"));return}let g=Y(p),f=c==="csv"?Q(g):Be(g);R(`table.${c==="csv"?"csv":"md"}`,f,c==="csv"?"text/csv":"text/markdown"),r(!1),n==null||n(c);}catch(l){o==null||o(l);}};return useEffect(()=>{let c=m=>{i.current&&!i.current.contains(m.target)&&r(false);};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c);}},[]),jsxs("div",{className:"relative",ref:i,children:[jsx("button",{className:u("cursor-pointer p-1 text-muted-foreground transition-all hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",t),disabled:a,onClick:()=>r(!s),title:"Download table",type:"button",children:e!=null?e:jsx(DownloadIcon,{size:14})}),s&&jsxs("div",{className:"absolute top-full right-0 z-10 mt-1 min-w-[120px] overflow-hidden rounded-md border border-border bg-background shadow-lg",children:[jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>d("csv"),title:"Download table as CSV",type:"button",children:"CSV"}),jsx("button",{className:"w-full px-3 py-2 text-left text-sm transition-colors hover:bg-muted/40",onClick:()=>d("markdown"),title:"Download table as Markdown",type:"button",children:"Markdown"})]})]})};var Xe=({children:e,className:t,showControls:n,...o})=>jsxs("div",{className:"my-4 flex flex-col space-y-2","data-streamdown":"table-wrapper",children:[n&&jsxs("div",{className:"flex items-center justify-end gap-1",children:[jsx(Oe,{}),jsx($e,{})]}),jsx("div",{className:"overflow-x-auto",children:jsx("table",{className:u("w-full border-collapse border border-border",t),"data-streamdown":"table",...o,children:e})})]});var fo=lazy(()=>import('./code-block-IT6T5CEO.js').then(e=>({default:e.CodeBlock}))),go=lazy(()=>import('./mermaid-VLURNSYL.js').then(e=>({default:e.Mermaid}))),bo=/language-([^\s]+)/;function re(e,t){if(!(e!=null&&e.position||t!=null&&t.position))return  true;if(!(e!=null&&e.position&&(t!=null&&t.position)))return  false;let n=e.position.start,o=t.position.start,s=e.position.end,r=t.position.end;return (n==null?void 0:n.line)===(o==null?void 0:o.line)&&(n==null?void 0:n.column)===(o==null?void 0:o.column)&&(s==null?void 0:s.line)===(r==null?void 0:r.line)&&(s==null?void 0:s.column)===(r==null?void 0:r.column)}function x(e,t){return e.className===t.className&&re(e.node,t.node)}var pe=(e,t)=>typeof e=="boolean"?e:e[t]!==false,ne=(e,t)=>{if(typeof e=="boolean")return e;let n=e.mermaid;return n===false?false:n===true||n===void 0?true:n[t]!==false},ue=memo(({children:e,className:t,node:n,...o})=>jsx("ol",{className:u("list-inside list-decimal whitespace-normal",t),"data-streamdown":"ordered-list",...o,children:e}),(e,t)=>x(e,t));ue.displayName="MarkdownOl";var Ve=memo(({children:e,className:t,node:n,...o})=>jsx("li",{className:u("py-1 [&>p]:inline",t),"data-streamdown":"list-item",...o,children:e}),(e,t)=>e.className===t.className&&re(e.node,t.node));Ve.displayName="MarkdownLi";var Ke=memo(({children:e,className:t,node:n,...o})=>jsx("ul",{className:u("list-inside list-disc whitespace-normal",t),"data-streamdown":"unordered-list",...o,children:e}),(e,t)=>x(e,t));Ke.displayName="MarkdownUl";var Ze=memo(({className:e,node:t,...n})=>jsx("hr",{className:u("my-6 border-border",e),"data-streamdown":"horizontal-rule",...n}),(e,t)=>x(e,t));Ze.displayName="MarkdownHr";var Ue=memo(({children:e,className:t,node:n,...o})=>jsx("span",{className:u("font-semibold",t),"data-streamdown":"strong",...o,children:e}),(e,t)=>x(e,t));Ue.displayName="MarkdownStrong";var Ge=memo(({children:e,className:t,href:n,node:o,...s})=>{let r=n==="streamdown:incomplete-link";return jsx("a",{className:u("wrap-anywhere font-medium text-primary underline",t),"data-incomplete":r,"data-streamdown":"link",href:n,rel:"noreferrer",target:"_blank",...s,children:e})},(e,t)=>x(e,t)&&e.href===t.href);Ge.displayName="MarkdownA";var _e=memo(({children:e,className:t,node:n,...o})=>jsx("h1",{className:u("mt-6 mb-2 font-semibold text-3xl",t),"data-streamdown":"heading-1",...o,children:e}),(e,t)=>x(e,t));_e.displayName="MarkdownH1";var Ye=memo(({children:e,className:t,node:n,...o})=>jsx("h2",{className:u("mt-6 mb-2 font-semibold text-2xl",t),"data-streamdown":"heading-2",...o,children:e}),(e,t)=>x(e,t));Ye.displayName="MarkdownH2";var Qe=memo(({children:e,className:t,node:n,...o})=>jsx("h3",{className:u("mt-6 mb-2 font-semibold text-xl",t),"data-streamdown":"heading-3",...o,children:e}),(e,t)=>x(e,t));Qe.displayName="MarkdownH3";var et=memo(({children:e,className:t,node:n,...o})=>jsx("h4",{className:u("mt-6 mb-2 font-semibold text-lg",t),"data-streamdown":"heading-4",...o,children:e}),(e,t)=>x(e,t));et.displayName="MarkdownH4";var tt=memo(({children:e,className:t,node:n,...o})=>jsx("h5",{className:u("mt-6 mb-2 font-semibold text-base",t),"data-streamdown":"heading-5",...o,children:e}),(e,t)=>x(e,t));tt.displayName="MarkdownH5";var ot=memo(({children:e,className:t,node:n,...o})=>jsx("h6",{className:u("mt-6 mb-2 font-semibold text-sm",t),"data-streamdown":"heading-6",...o,children:e}),(e,t)=>x(e,t));ot.displayName="MarkdownH6";var nt=memo(({children:e,className:t,node:n,...o})=>{let{controls:s}=useContext(C),r=pe(s,"table");return jsx(Xe,{className:t,"data-streamdown":"table-wrapper",showControls:r,...o,children:e})},(e,t)=>x(e,t));nt.displayName="MarkdownTable";var rt=memo(({children:e,className:t,node:n,...o})=>jsx("thead",{className:u("bg-muted/80",t),"data-streamdown":"table-header",...o,children:e}),(e,t)=>x(e,t));rt.displayName="MarkdownThead";var st=memo(({children:e,className:t,node:n,...o})=>jsx("tbody",{className:u("divide-y divide-border bg-muted/40",t),"data-streamdown":"table-body",...o,children:e}),(e,t)=>x(e,t));st.displayName="MarkdownTbody";var at=memo(({children:e,className:t,node:n,...o})=>jsx("tr",{className:u("border-border border-b",t),"data-streamdown":"table-row",...o,children:e}),(e,t)=>x(e,t));at.displayName="MarkdownTr";var it=memo(({children:e,className:t,node:n,...o})=>jsx("th",{className:u("whitespace-nowrap px-4 py-2 text-left font-semibold text-sm",t),"data-streamdown":"table-header-cell",...o,children:e}),(e,t)=>x(e,t));it.displayName="MarkdownTh";var lt=memo(({children:e,className:t,node:n,...o})=>jsx("td",{className:u("px-4 py-2 text-sm",t),"data-streamdown":"table-cell",...o,children:e}),(e,t)=>x(e,t));lt.displayName="MarkdownTd";var dt=memo(({children:e,className:t,node:n,...o})=>jsx("blockquote",{className:u("my-4 border-muted-foreground/30 border-l-4 pl-4 text-muted-foreground italic",t),"data-streamdown":"blockquote",...o,children:e}),(e,t)=>x(e,t));dt.displayName="MarkdownBlockquote";var ct=memo(({children:e,className:t,node:n,...o})=>jsx("sup",{className:u("text-sm",t),"data-streamdown":"superscript",...o,children:e}),(e,t)=>x(e,t));ct.displayName="MarkdownSup";var mt=memo(({children:e,className:t,node:n,...o})=>jsx("sub",{className:u("text-sm",t),"data-streamdown":"subscript",...o,children:e}),(e,t)=>x(e,t));mt.displayName="MarkdownSub";var pt=memo(({children:e,className:t,node:n,...o})=>{if("data-footnotes"in o){let r=d=>{var p,g;if(!isValidElement(d))return  false;let c=Array.isArray(d.props.children)?d.props.children:[d.props.children],m=false,l=false;for(let f of c)if(f){if(typeof f=="string")f.trim()!==""&&(m=true);else if(isValidElement(f))if(((p=f.props)==null?void 0:p["data-footnote-backref"])!==void 0)l=true;else {let b=Array.isArray(f.props.children)?f.props.children:[f.props.children];for(let w of b){if(typeof w=="string"&&w.trim()!==""){m=true;break}if(isValidElement(w)&&((g=w.props)==null?void 0:g["data-footnote-backref"])===void 0){m=true;break}}}}return l&&!m},i=Array.isArray(e)?e.map(d=>{if(!isValidElement(d))return d;if(d.type===ue){let m=(Array.isArray(d.props.children)?d.props.children:[d.props.children]).filter(l=>!r(l));return m.length===0?null:{...d,props:{...d.props,children:m}}}return d}):e;return (Array.isArray(i)?i.some(d=>d!==null):i!==null)?jsx("section",{className:t,...o,children:i}):null}return jsx("section",{className:t,...o,children:e})},(e,t)=>x(e,t));pt.displayName="MarkdownSection";var ho=({node:e,className:t,children:n,...o})=>{var l,p,g;let s=((l=e==null?void 0:e.position)==null?void 0:l.start.line)===((p=e==null?void 0:e.position)==null?void 0:p.end.line),{mermaid:r,controls:i}=useContext(C);if(s)return jsx("code",{className:u("rounded bg-muted px-1.5 py-0.5 font-mono text-sm",t),"data-streamdown":"inline-code",...o,children:n});let a=t==null?void 0:t.match(bo),d=(g=a==null?void 0:a.at(1))!=null?g:"",c="";if(isValidElement(n)&&n.props&&typeof n.props=="object"&&"children"in n.props&&typeof n.props.children=="string"?c=n.props.children:typeof n=="string"&&(c=n),d==="mermaid"){let f=pe(i,"mermaid"),b=ne(i,"download"),w=ne(i,"copy"),v=ne(i,"fullscreen"),T=ne(i,"panZoom");return jsx(Suspense,{fallback:jsx(de,{}),children:jsxs("div",{className:u("group relative my-4 h-auto rounded-xl border p-4",t),"data-streamdown":"mermaid-block",children:[f&&(b||w||v)&&jsxs("div",{className:"flex items-center justify-end gap-2",children:[b&&jsx(Se,{chart:c,config:r==null?void 0:r.config}),w&&jsx(ie,{code:c}),v&&jsx(De,{chart:c,config:r==null?void 0:r.config})]}),jsx(go,{chart:c,config:r==null?void 0:r.config,showControls:T})]})})}let m=pe(i,"code");return jsx(Suspense,{fallback:jsx(de,{}),children:jsx(fo,{className:u("overflow-x-auto border-border border-t",t),code:c,language:d,children:m&&jsxs(Fragment,{children:[jsx(Me,{code:c,language:d}),jsx(ie,{})]})})})},ut=memo(ho,(e,t)=>e.className===t.className&&re(e.node,t.node));ut.displayName="MarkdownCode";var ft=memo(Pe,(e,t)=>e.className===t.className&&re(e.node,t.node));ft.displayName="MarkdownImg";var gt=memo(({children:e,className:t,node:n,...o})=>{var i;let r=(Array.isArray(e)?e:[e]).filter(a=>a!=null&&a!=="");return r.length===1&&isValidElement(r[0])&&((i=r[0].props.node)==null?void 0:i.tagName)==="img"?jsx(Fragment,{children:e}):jsx("p",{className:t,...o,children:e})},(e,t)=>x(e,t));gt.displayName="MarkdownParagraph";var bt={ol:ue,li:Ve,ul:Ke,hr:Ze,strong:Ue,a:Ge,h1:_e,h2:Ye,h3:Qe,h4:et,h5:tt,h6:ot,table:nt,thead:rt,tbody:st,tr:at,th:it,td:lt,blockquote:dt,code:ut,img:ft,pre:({children:e})=>e,sup:ct,sub:mt,p:gt,section:pt};var yt=[],wt={allowDangerousHtml:true},se=new WeakMap,fe=class{constructor(){this.cache=new Map;this.keyCache=new WeakMap;this.maxSize=100;}generateCacheKey(t){let n=this.keyCache.get(t);if(n)return n;let o=t.rehypePlugins,s=t.remarkPlugins,r=t.remarkRehypeOptions;if(!(o||s||r)){let l="default";return this.keyCache.set(t,l),l}let i=l=>{if(!l||l.length===0)return "";let p="";for(let g=0;g<l.length;g+=1){let f=l[g];if(g>0&&(p+=","),Array.isArray(f)){let[b,w]=f;if(typeof b=="function"){let v=se.get(b);v||(v=b.name,se.set(b,v)),p+=v;}else p+=String(b);p+=":",p+=JSON.stringify(w);}else if(typeof f=="function"){let b=se.get(f);b||(b=f.name,se.set(f,b)),p+=b;}else p+=String(f);}return p},a=i(o),d=i(s),c=r?JSON.stringify(r):"",m=`${d}::${a}::${c}`;return this.keyCache.set(t,m),m}get(t){let n=this.generateCacheKey(t),o=this.cache.get(n);return o&&(this.cache.delete(n),this.cache.set(n,o)),o}set(t,n){let o=this.generateCacheKey(t);if(this.cache.size>=this.maxSize){let s=this.cache.keys().next().value;s&&this.cache.delete(s);}this.cache.set(o,n);}clear(){this.cache.clear();}},kt=new fe,ge=e=>{let t=Po(e),n=e.children||"";return No(t.runSync(t.parse(n),n),e)},Po=e=>{let t=kt.get(e);if(t)return t;let n=To(e);return kt.set(e,n),n},To=e=>{let t=e.rehypePlugins||yt,n=e.remarkPlugins||yt,o=e.remarkRehypeOptions?{...wt,...e.remarkRehypeOptions}:wt;return unified().use(xo).use(n).use(Co,o).use(t)},No=(e,t)=>toJsxRuntime(e,{Fragment:Fragment,components:t.components,ignoreInvalidStyle:true,jsx:jsx,jsxs:jsxs,passKeys:true,passNode:true});var Ro=/\[\^[^\]\s]{1,200}\](?!:)/,Io=/\[\^[^\]\s]{1,200}\]:/,Eo=/<\/(\w+)>/,Do=/<(\w+)[\s>]/,be=e=>{let t=0;for(;t<e.length&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t+=1;return t+1<e.length&&e[t]==="$"&&e[t+1]==="$"},Lo=e=>{let t=e.length-1;for(;t>=0&&(e[t]===" "||e[t]==="	"||e[t]===`
`||e[t]==="\r");)t-=1;return t>=1&&e[t]==="$"&&e[t-1]==="$"},he=e=>{let t=0;for(let n=0;n<e.length-1;n+=1)e[n]==="$"&&e[n+1]==="$"&&(t+=1,n+=1);return t},ye=e=>{let t=Ro.test(e),n=Io.test(e);if(t||n)return [e];let o=Lexer.lex(e,{gfm:true}),s=[],r=[];for(let i of o){let a=i.raw,d=s.length;if(r.length>0){if(s[d-1]+=a,i.type==="html"){let m=a.match(Eo);if(m){let l=m[1];r.at(-1)===l&&r.pop();}}continue}if(i.type==="html"&&i.block){let m=a.match(Do);if(m){let l=m[1];a.includes(`</${l}>`)||r.push(l);}}if(a.trim()==="$$"&&d>0){let m=s[d-1],l=be(m),p=he(m);if(l&&p%2===1){s[d-1]=m+a;continue}}if(d>0&&Lo(a)){let m=s[d-1],l=be(m),p=he(m),g=he(a);if(l&&p%2===1&&!be(a)&&g===1){s[d-1]=m+a;continue}}s.push(a);}return s};var Wo={raw:qo,katex:[we,{errorColor:"var(--color-muted-foreground)"}],sanitize:[$o,{}],harden:[harden,{allowedImagePrefixes:["*"],allowedLinkPrefixes:["*"],allowedProtocols:["*"],defaultOrigin:void 0,allowDataImages:true}]},Vo={gfm:[Fo,{}],math:[ke,{singleDollarTextMath:false}],cjkFriendly:[zo,{}],cjkFriendlyGfmStrikethrough:[Xo,{}]},Ko=Object.values(Wo),Zo=Object.values(Vo),Uo={shikiTheme:["github-light","github-dark"],controls:true,isAnimating:false,mode:"streaming",mermaid:void 0},C=createContext(Uo),Ct=memo(({content:e,shouldParseIncompleteMarkdown:t,...n})=>{let o=useMemo(()=>typeof e=="string"&&t?Jo(e.trim()):e,[e,t]);return jsx(ge,{...n,children:o})},(e,t)=>{if(e.content!==t.content||e.shouldParseIncompleteMarkdown!==t.shouldParseIncompleteMarkdown||e.index!==t.index)return  false;if(e.components!==t.components){let n=Object.keys(e.components||{}),o=Object.keys(t.components||{});if(n.length!==o.length||n.some(s=>{var r,i;return ((r=e.components)==null?void 0:r[s])!==((i=t.components)==null?void 0:i[s])}))return  false}return !(e.rehypePlugins!==t.rehypePlugins||e.remarkPlugins!==t.remarkPlugins)});Ct.displayName="Block";var Go=["github-light","github-dark"],_o=memo(({children:e,mode:t="streaming",parseIncompleteMarkdown:n=true,components:o,rehypePlugins:s=Ko,remarkPlugins:r=Zo,className:i,shikiTheme:a=Go,mermaid:d,controls:c=true,isAnimating:m=false,BlockComponent:l=Ct,parseMarkdownIntoBlocksFn:p=ye,...g})=>{let f=useId(),[b,w]=useTransition(),[v,T]=useState([]),M=useMemo(()=>p(typeof e=="string"?e:""),[e,p]);useEffect(()=>{t==="streaming"?w(()=>{T(M);}):T(M);},[M,t]);let P=t==="streaming"?v:M,j=useMemo(()=>P.map((I,E)=>`${f}-${E}`),[P.length,f]),A=useMemo(()=>({shikiTheme:a,controls:c,isAnimating:m,mode:t,mermaid:d}),[a,c,m,t,d]),H=useMemo(()=>({...bt,...o}),[o]);return useEffect(()=>{if(!(Array.isArray(s)&&s.some(S=>Array.isArray(S)?S[0]===we:S===we)))return;let E=false;if(Array.isArray(r)){let S=r.find(Z=>Array.isArray(Z)?Z[0]===ke:Z===ke);S&&Array.isArray(S)&&S[1]&&(E=S[1].singleDollarTextMath===true);}let D=typeof e=="string"?e:"",O=D.includes("$$"),y=E&&(/[^$]\$[^$]/.test(D)||/^\$[^$]/.test(D)||/[^$]\$$/.test(D));(O||y)&&import('katex/dist/katex.min.css');},[s,r,e]),t==="static"?jsx(C.Provider,{value:A,children:jsx("div",{className:u("space-y-4 whitespace-normal",i),children:jsx(ge,{components:H,rehypePlugins:s,remarkPlugins:r,...g,children:e})})}):jsx(C.Provider,{value:A,children:jsx("div",{className:u("space-y-4 whitespace-normal",i),children:P.map((I,E)=>jsx(l,{components:H,content:I,index:E,rehypePlugins:s,remarkPlugins:r,shouldParseIncompleteMarkdown:n,...g},j[E]))})})},(e,t)=>e.children===t.children&&e.shikiTheme===t.shikiTheme&&e.isAnimating===t.isAnimating&&e.mode===t.mode);_o.displayName="Streamdown";var Nt=({children:e,className:t,minZoom:n=.5,maxZoom:o=3,zoomStep:s=.1,showControls:r=true,initialZoom:i=1,fullscreen:a=false})=>{let d=useRef(null),c=useRef(null),[m,l]=useState(i),[p,g]=useState({x:0,y:0}),[f,b]=useState(false),[w,v]=useState({x:0,y:0}),[T,M]=useState({x:0,y:0}),P=useCallback(y=>{l(N=>Math.max(n,Math.min(o,N+y)));},[n,o]),j=useCallback(()=>{P(s);},[P,s]),A=useCallback(()=>{P(-s);},[P,s]),H=useCallback(()=>{l(i),g({x:0,y:0});},[i]),I=useCallback(y=>{y.preventDefault();let N=y.deltaY>0?-s:s;P(N);},[P,s]),E=useCallback(y=>{if(y.button!==0||y.isPrimary===false)return;b(true),v({x:y.clientX,y:y.clientY}),M(p);let N=y.currentTarget;N instanceof HTMLElement&&N.setPointerCapture(y.pointerId);},[p]),D=useCallback(y=>{if(!f)return;y.preventDefault();let N=y.clientX-w.x,S=y.clientY-w.y;g({x:T.x+N,y:T.y+S});},[f,w,T]),O=useCallback(y=>{b(false);let N=y.currentTarget;N instanceof HTMLElement&&N.releasePointerCapture(y.pointerId);},[]);return useEffect(()=>{let y=d.current;if(y)return y.addEventListener("wheel",I,{passive:false}),()=>{y.removeEventListener("wheel",I);}},[I]),useEffect(()=>{let y=c.current;if(y&&f)return document.body.style.userSelect="none",y.addEventListener("pointermove",D,{passive:false}),y.addEventListener("pointerup",O),y.addEventListener("pointercancel",O),()=>{document.body.style.userSelect="",y.removeEventListener("pointermove",D),y.removeEventListener("pointerup",O),y.removeEventListener("pointercancel",O);}},[f,D,O]),jsxs("div",{className:u("relative",a?"h-full w-full":"w-full",t),ref:d,style:{cursor:f?"grabbing":"grab"},children:[r&&jsxs("div",{className:u("absolute z-10 flex flex-col gap-1 rounded-md border border-border bg-background/90 p-1 shadow-sm backdrop-blur-sm",a?"bottom-4 left-4":"bottom-2 left-2"),children:[jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:m>=o,onClick:j,title:"Zoom in",type:"button",children:jsx(ZoomInIcon,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground disabled:cursor-not-allowed disabled:opacity-50",disabled:m<=n,onClick:A,title:"Zoom out",type:"button",children:jsx(ZoomOutIcon,{size:16})}),jsx("button",{className:"flex items-center justify-center rounded p-1.5 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",onClick:H,title:"Reset zoom and pan",type:"button",children:jsx(RotateCcwIcon,{size:16})})]}),jsx("div",{className:u("origin-center transition-transform duration-150 ease-out",a&&"flex w-full items-center justify-center"),onPointerDown:E,ref:c,role:"application",style:{transform:`translate(${p.x}px, ${p.y}px) scale(${m})`,transformOrigin:"center center",touchAction:"none",willChange:"transform"},children:e})]})};var Ee=({chart:e,className:t,config:n,fullscreen:o=false,showControls:s=true})=>{let[r,i]=useState(null),[a,d]=useState(true),[c,m]=useState(""),[l,p]=useState(""),[g,f]=useState(0),{mermaid:b}=useContext(C),w=b==null?void 0:b.errorComponent;if(useEffect(()=>{(async()=>{try{i(null),d(!0);let M=await _(n),P=e.split("").reduce((H,I)=>(H<<5)-H+I.charCodeAt(0)|0,0),j=`mermaid-${Math.abs(P)}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{svg:A}=await M.render(j,e);m(A),p(A);}catch(M){if(!(l||c)){let P=M instanceof Error?M.message:"Failed to render Mermaid chart";i(P);}}finally{d(false);}})();},[e,n,g]),a&&!c&&!l)return jsx("div",{className:u("my-4 flex justify-center p-4",t),children:jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-current border-b-2"}),jsx("span",{className:"text-sm",children:"Loading diagram..."})]})});if(r&&!c&&!l){let T=()=>f(M=>M+1);return w?jsx(w,{chart:e,error:r,retry:T}):jsxs("div",{className:u("rounded-lg border border-red-200 bg-red-50 p-4",t),children:[jsxs("p",{className:"font-mono text-red-700 text-sm",children:["Mermaid Error: ",r]}),jsxs("details",{className:"mt-2",children:[jsx("summary",{className:"cursor-pointer text-red-600 text-xs",children:"Show Code"}),jsx("pre",{className:"mt-2 overflow-x-auto rounded bg-red-100 p-2 text-red-800 text-xs",children:e})]})]})}let v=c||l;return jsx(Nt,{className:u(o?"h-full w-full overflow-hidden":"my-4 overflow-hidden",t),fullscreen:o,maxZoom:3,minZoom:.5,showControls:s,zoomStep:.1,children:jsx("div",{"aria-label":"Mermaid chart",className:u("flex justify-center",o&&"h-full w-full items-center"),dangerouslySetInnerHTML:{__html:v},role:"img"})})};export{u as a,Dt as b,Ee as c,ye as d,Wo as e,Vo as f,C as g,Ct as h,_o as i};