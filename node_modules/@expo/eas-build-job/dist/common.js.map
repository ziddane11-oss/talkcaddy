{"version":3,"file":"common.js","sourceRoot":"","sources":["../src/common.ts"],"names":[],"mappings":"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","sourcesContent":["import Joi from 'joi';\nimport { z } from 'zod';\n\nimport { BuildPhase, BuildPhaseResult } from './logs';\nimport { validateSteps } from './step';\n\nexport enum BuildMode {\n  BUILD = 'build',\n  RESIGN = 'resign',\n  CUSTOM = 'custom',\n  REPACK = 'repack',\n}\n\nexport enum Workflow {\n  GENERIC = 'generic',\n  MANAGED = 'managed',\n  UNKNOWN = 'unknown',\n}\n\nexport enum Platform {\n  ANDROID = 'android',\n  IOS = 'ios',\n}\n\nexport enum ArchiveSourceType {\n  NONE = 'NONE',\n  URL = 'URL',\n  PATH = 'PATH',\n  GCS = 'GCS',\n  GIT = 'GIT',\n  R2 = 'R2',\n}\n\nexport enum BuildTrigger {\n  EAS_CLI = 'EAS_CLI',\n  GIT_BASED_INTEGRATION = 'GIT_BASED_INTEGRATION',\n}\n\nexport type ArchiveSource =\n  | { type: ArchiveSourceType.NONE }\n  | { type: ArchiveSourceType.GCS; bucketKey: string; metadataLocation?: string }\n  | { type: ArchiveSourceType.R2; bucketKey: string }\n  | { type: ArchiveSourceType.URL; url: string }\n  | { type: ArchiveSourceType.PATH; path: string }\n  | {\n      type: ArchiveSourceType.GIT;\n      /**\n       * Url that can be used to clone repository.\n       * It should contain embedded credentials for private registries.\n       */\n      repositoryUrl: string;\n      /** A Git ref - points to a branch head, tag head or a branch name. */\n      gitRef: string | null;\n      /**\n       * Git commit hash.\n       */\n      gitCommitHash: string;\n    };\n\nexport const ArchiveSourceSchema = Joi.object<ArchiveSource>({\n  type: Joi.string()\n    .valid(...Object.values(ArchiveSourceType))\n    .required(),\n})\n  .when(Joi.object({ type: ArchiveSourceType.GCS }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.GCS).required(),\n      bucketKey: Joi.string().required(),\n      metadataLocation: Joi.string(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.URL }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.URL).required(),\n      url: Joi.string().uri().required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.GIT }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.GIT).required(),\n      repositoryUrl: Joi.string().required(),\n      gitCommitHash: Joi.string().required(),\n      gitRef: Joi.string().allow(null).required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.PATH }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.PATH).required(),\n      path: Joi.string().required(),\n    }),\n  });\n\nexport const ArchiveSourceSchemaZ = z.discriminatedUnion('type', [\n  z.object({\n    type: z.literal(ArchiveSourceType.GIT),\n    repositoryUrl: z.string().url(),\n    gitRef: z.string().nullable(),\n    gitCommitHash: z.string(),\n  }),\n  z.object({\n    type: z.literal(ArchiveSourceType.PATH),\n    path: z.string(),\n  }),\n  z.object({\n    type: z.literal(ArchiveSourceType.URL),\n    url: z.string().url(),\n  }),\n  z.object({\n    type: z.literal(ArchiveSourceType.GCS),\n    bucketKey: z.string(),\n    metadataLocation: z.string().optional(),\n  }),\n  z.object({\n    type: z.literal(ArchiveSourceType.NONE),\n  }),\n]);\n\nexport type Env = Record<string, string>;\nexport const EnvSchema = Joi.object().pattern(Joi.string(), Joi.string());\n\nexport type EnvironmentSecret = {\n  name: string;\n  type: EnvironmentSecretType;\n  value: string;\n};\nexport enum EnvironmentSecretType {\n  STRING = 'string',\n  FILE = 'file',\n}\nexport const EnvironmentSecretsSchema = Joi.array().items(\n  Joi.object({\n    name: Joi.string().required(),\n    value: Joi.string().allow('').required(),\n    type: Joi.string()\n      .valid(...Object.values(EnvironmentSecretType))\n      .required(),\n  })\n);\nexport const EnvironmentSecretZ = z.object({\n  name: z.string(),\n  value: z.string(),\n  type: z.nativeEnum(EnvironmentSecretType),\n});\n\nexport interface Cache {\n  disabled: boolean;\n  clear: boolean;\n  key?: string;\n  /**\n   * @deprecated We don't cache anything by default anymore.\n   */\n  cacheDefaultPaths?: boolean;\n  /**\n   * @deprecated We use paths now since there is no default caching anymore.\n   */\n  customPaths?: string[];\n  paths: string[];\n}\n\nexport const CacheSchema = Joi.object({\n  disabled: Joi.boolean().default(false),\n  clear: Joi.boolean().default(false),\n  key: Joi.string().allow('').max(128),\n  cacheDefaultPaths: Joi.boolean(),\n  customPaths: Joi.array().items(Joi.string()),\n  paths: Joi.array().items(Joi.string()).default([]),\n});\n\nexport interface BuildPhaseStats {\n  buildPhase: BuildPhase;\n  result: BuildPhaseResult;\n  durationMs: number;\n}\n\nconst GitHubContextZ = z.object({\n  triggering_actor: z.string().optional(),\n  event_name: z.enum(['push', 'pull_request', 'workflow_dispatch', 'schedule']),\n  sha: z.string(),\n  ref: z.string(),\n  ref_name: z.string(),\n  ref_type: z.string(),\n  commit_message: z.string().optional(),\n  label: z.string().optional(),\n  repository: z.string().optional(),\n  repository_owner: z.string().optional(),\n  event: z\n    .object({\n      label: z\n        .object({\n          name: z.string(),\n        })\n        .optional(),\n      head_commit: z\n        .object({\n          message: z.string(),\n          id: z.string(),\n        })\n        .optional(),\n      pull_request: z\n        .object({\n          number: z.number(),\n        })\n        .optional(),\n      number: z.number().optional(),\n      schedule: z.string().optional(),\n      inputs: z.record(z.string(), z.union([z.string(), z.number(), z.boolean()])).optional(),\n    })\n    .optional(),\n});\n\nexport const StaticWorkflowInterpolationContextZ = z.object({\n  after: z.record(\n    z.string(),\n    z.object({\n      status: z.string(),\n      outputs: z.record(z.string(), z.string().nullable()),\n    })\n  ),\n  needs: z.record(\n    z.string(),\n    z.object({\n      status: z.string(),\n      outputs: z.record(z.string(), z.string().nullable()),\n    })\n  ),\n  inputs: z.record(z.string(), z.union([z.string(), z.number(), z.boolean()])).optional(),\n  github:\n    // We need to .optional() to support jobs that are not triggered by a GitHub event.\n    GitHubContextZ.optional(),\n  workflow: z\n    .object({\n      id: z.string(),\n      name: z.string(),\n      filename: z.string(),\n      url: z.string().url(),\n    })\n    .passthrough(),\n});\n\nexport type StaticWorkflowInterpolationContext = z.infer<\n  typeof StaticWorkflowInterpolationContextZ\n>;\n\nexport type DynamicInterpolationContext = {\n  env: Record<string, string | undefined>;\n  success: () => boolean;\n  failure: () => boolean;\n  always: () => boolean;\n  never: () => boolean;\n  fromJSON: (value: string) => unknown;\n  toJSON: (value: unknown) => string;\n  contains: (value: string, substring: string) => boolean;\n  startsWith: (value: string, prefix: string) => boolean;\n  endsWith: (value: string, suffix: string) => boolean;\n  hashFiles: (...globs: string[]) => string;\n  replaceAll: (input: string, stringToReplace: string, replacementString: string) => string;\n};\n\nexport type WorkflowInterpolationContext = StaticWorkflowInterpolationContext &\n  DynamicInterpolationContext;\n\nexport const CustomBuildConfigSchema = Joi.object().when('.mode', {\n  is: [BuildMode.CUSTOM, BuildMode.REPACK],\n  then: Joi.object().when('.customBuildConfig.path', {\n    is: Joi.exist(),\n    then: Joi.object({\n      customBuildConfig: Joi.object({\n        path: Joi.string().required(),\n      }).required(),\n      steps: Joi.any().strip(),\n      outputs: Joi.any().strip(),\n    }),\n    otherwise: Joi.object({\n      customBuildConfig: Joi.any().strip(),\n      steps: Joi.array()\n        .items(Joi.any())\n        .required()\n        .custom((steps) => validateSteps(steps), 'steps validation'),\n      outputs: Joi.object().pattern(Joi.string(), Joi.string()).required(),\n    }),\n  }),\n  otherwise: Joi.object({\n    customBuildConfig: Joi.any().strip(),\n    steps: Joi.any().strip(),\n    outputs: Joi.any().strip(),\n  }),\n});\n\nexport enum EasCliNpmTags {\n  STAGING = 'latest-eas-build-staging',\n  PRODUCTION = 'latest-eas-build',\n}\n"]}